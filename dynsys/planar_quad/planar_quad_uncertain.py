import sympy as sp
import numpy as np
from dynsys.ctrl_affine_sys import CtrlAffineSys

class PLANAR_QUAD_UNCERTAIN(CtrlAffineSys):
    def __init__(self, params=None):
        super().__init__(params)
    
    def define_system_symbolic(self):
        # Symbolic states
        px, pz, phi, vx, vz, phi_dot = sp.symbols('px pz phi vx vz phi_dot')
        x = sp.Matrix([px, pz, phi, vx, vz, phi_dot])
        
        l = self.params['l'] # (m) half-width of quadrotor
        m = self.params['m'] # (kg) mass of the quadrotor
        grav = self.params['g'] # (m/s^2) gravity
        J = self.params['J'] # (kgm^2), moment of inertia

        f = sp.Matrix([
            x[3] * sp.cos(x[2]) - x[4] * sp.sin(x[2]),   # px_dot
            x[3] * sp.sin(x[2]) + x[4] * sp.cos(x[2]),   # pz_dot
            x[5],                                        # phi_dot
            x[5] * x[4] - grav * sp.sin(x[2]),           # vx_dot
            -x[5] * x[3] - grav * sp.cos(x[2]),          # vz_dot
            sp.Integer(0)                                # phi_ddot
        ])

        g = sp.Matrix([
            [0,              0],
            [0,              0],
            [0,              0],
            [0,              0],
            [1/m,            1/m],
            [l/J,           -l/J]
        ])

        # Define the symbolic uncertainty term Y(x)
        Y = sp.Matrix([[0, 0, 0, 0], 
                       [0, 0, 0, 0],
                       [0, 0, 0, 0],
                       [sp.cos(x[2]), -x[3], sp.sin(x[2]), 0],
                       [-sp.sin(x[2]), 0, sp.cos(x[2]), -x[4]],
                       [0, 0, 0, 0]])
        
        # Define symbolic uncertainty parameters
        a0, a1, a2, a3 = sp.symbols('a0 a1 a2 a3')
        a = sp.Matrix([a0, a1, a2, a3])

        return x, f, g, Y, a

    # CCM functions generated by SOS in MATLAB
    # Converting MATLAB functions to Python functions: 
    #   in1(k,:) => x[k-1]
    #   in2(k,:) => a[k-1]
    #    .*   => *
    #    .^   => **
    #   reshape([],[(6,6]) => np.reshape([],(6,6))
    #   remove all semicolons

    def W_fcn(self, x, a):
        #W_fcn
        #    W_fcn = W_fcn(IN1,IN2)
        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    24-Feb-2026 12:05:55

        a1 = a[0]
        a2 = a[1]
        a3 = a[2]
        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a1 ** 3
        t4 = a2 ** 2
        t5 = a2 ** 3
        t6 = a3 ** 2
        t7 = a3 ** 3
        t8 = x3 ** 2
        t9 = x3 ** 3
        t10 = x4 ** 2
        t11 = x4 ** 3
        t12 = a2 * x4 * 3.08023069551e-3
        t13 = a1 * 2.68317708602e-2
        t14 = x3 * x4 * 2.25068523984e-2
        t15 = x3 * 4.61435080365e-1
        t17 = x3 * 2.9608954212e-1
        t19 = x4 * 7.3665774041e-2
        t21 = a2 * 5.35934846484e-3
        t22 = a2 * 6.46936842344e-2
        t23 = a2 * a3 * 1.13065994339e-2
        t24 = a3 * x3 * 9.67529817934e-4
        t25 = x3 * 1.61261006517e-2
        t26 = a1 * 2.21399581844e-2
        t27 = a3 * 2.34234645098e-2
        t28 = x4 * 2.09682356703e-2
        t29 = x4 * 3.774400023e-2
        t30 = a2 * 1.97770971087e-2
        t32 = a3 * 5.02964407779e-3
        t33 = x3 * 1.90042055678e-2
        t35 = x4 * 2.30809697919e-2
        t36 = a1 * 1.19232388017e-2
        t37 = a2 * 3.06489436569e-2
        t38 = a2 * 4.39019679501e-2
        t39 = a2 * 1.11390322761e-2
        t40 = x3 * 5.70726035313e-2
        t43 = a1 * x3 * x4 * 2.82297483558e-4
        t44 = x4 * 1.2964458544e-2
        t45 = a1 * 1.0860422771e-2
        t46 = a2 * a3 * 2.51801166602e-3
        t48 = a2 * x4 * 1.82088599812e-2
        t49 = a2 * x4 * 5.1600621622e-3
        t51 = x3 * x4 * 1.84924879735e-2
        t52 = a3 * 9.048860167939999e-3
        t53 = x4 * 6.08903681562e-3
        t54 = a3 * 2.69624959184e-3
        t56 = a2 * x3 * 2.86830076673e-2
        t57 = x4 * 6.5971795314e-3
        t58 = a3 * x4 * 8.18518018284e-3
        t59 = x3 * 2.52566658352e-3
        t60 = a2 * 4.7266578611e-3
        t64 = a1 * 2.10199782909e-3
        t67 = x3 * 4.14145634146e-3
        t68 = x3 * 7.41272703873e-3
        t70 = x3 * x4 * 1.4691035153e-2
        t71 = a1 * x4 * 6.81393583931e-3
        t72 = x4 * 2.93290038401e-3
        t73 = x3 * x4 * 5.16654382872e-2
        t74 = a2 * x4 * 9.340139044740001e-3
        t75 = a2 * x3 * 1.45558050226e-2
        t77 = a3 * 1.01060803275e-3
        t78 = a1 * 2.53522454459e-3
        t79 = a3 * x3 * 4.74459967025e-3
        t80 = x3 * x4 * 1.95617173486e-2
        t82 = a1 * x4 * 2.30137176959e-3
        t85 = a3 * x4 * 3.59959866401e-3
        t87 = a2 * x3 * 7.68039268915e-3
        t88 = a3 * x3 * 1.26147483432e-2
        t90 = a1 * x3 * 1.39410489943e-2
        t91 = a1 * a3 * 1.52127636266e-3
        t93 = a2 * a3 * 3.76378195902e-3
        t94 = a3 * x4 * 2.96018994683e-3
        t96 = a3 * x4 * 5.0991772234e-4
        t97 = a2 * a3 * 4.21887677787e-3
        t99 = a1 * 1.0131142352e-4
        t100 = a3 * x3 * 9.52303437317e-3
        t101 = a1 * x4 * 2.88391142271e-3
        t102 = a2 * x3 * 1.34730790108e-2
        t103 = a2 * a3 * 7.29468891341e-3
        t104 = a1 * a3 * 1.13037708642e-3
        t109 = a3 * x3 * 2.46026029844e-3
        t110 = a3 * x4 * 1.84908518515e-3
        t111 = a1 * a3 * 6.69233679049e-4
        t112 = a1 * a2 * 5.89874460376e-3
        t113 = a2 * x3 * 6.64462196863e-3
        t114 = a2 * x4 * 6.43947819272e-3
        t115 = a1 * x4 * 1.76989125992e-3
        t116 = a1 * x4 * 1.14039065758e-3
        t117 = a1 * a2 * 1.50259633126e-3
        t118 = a3 * x3 * 6.67983360194e-3
        t119 = a1 * x3 * 2.2257495506e-3
        t120 = a1 * a3 * 9.873409799039999e-4
        t121 = a1 * 6.10496237055e-4
        t122 = a3 * 4.01087891107e-4
        t123 = a2 * a3 * 1.56486904605e-3
        t125 = a3 * 8.79039866319e-4
        t129 = a2 * x3 * 1.35025709194e-2
        t131 = x3 * x4 * 1.28725418869e-2
        t132 = a3 * x4 * 1.60764685139e-3
        t133 = a1 * x3 * 1.11938347363e-3
        t134 = x3 * x4 * 3.60305154347e-4
        t135 = a1 * a2 * 3.6395995365e-3
        t136 = a2 * a3 * 2.61278288e-3
        t138 = a2 * x4 * 3.77952493098e-3
        t141 = a3 * x4 * 3.86138030759e-4
        t142 = a2 * x3 * 2.9285504699e-3
        t146 = a3 * x3 * 1.39597774775e-2
        t148 = a2 * x3 * 2.48805364358e-3
        t150 = a1 * a2 * 2.09476005732e-3
        t151 = a1 * x4 * 3.15218290995e-3
        t152 = a3 * x3 * 8.343846479e-4
        t160 = a1 * a2 * 5.44913554529e-4
        t162 = a1 * a2 * 8.17980130464e-4
        t166 = a1 * x3 * 4.28886372515e-4
        t167 = a1 * a3 * 4.273725406e-4
        t173 = a1 * a3 * 1.35958447312e-4
        t181 = a1 * a3 * 2.94163940718e-4
        t188 = a2 * a3 * x3 * 1.32168131288e-5
        t189 = a2 * x4 * 6.79315658856e-4
        t191 = a1 * x3 * 7.22155128561e-4
        t192 = a1 * x3 * 6.77757158617e-4
        t197 = a1 * a3 * 1.13554827746e-4
        t212 = a1 * a2 * 7.44306348224e-4
        t214 = a3 * x4 * 5.17282467705e-4
        t215 = a2 * x4 * 4.63686103145e-4
        t220 = a1 * x4 * 2.60979256979e-4
        t228 = a2 * x3 * x4 * 6.22173924406e-5
        t232 = a3 * x3 * x4 * 2.62510126555e-4
        t234 = a1 * a3 * x4 * 4.74425654351e-5
        t244 = a2 * x3 * x4 * 7.721288568659999e-5
        t249 = a2 * x3 * x4 * 8.06042672231e-5
        t250 = a3 * x3 * x4 * 4.19362842167e-4
        t253 = a1 * x3 * x4 * 6.27308300359e-5
        t254 = a3 * x3 * x4 * 1.53879113248e-4
        t258 = a1 * a2 * 8.67700719984e-5
        t261 = a2 * a3 * x4 * 2.03809951337e-4
        t267 = a1 * a3 * x4 * 1.80514896636e-5
        t281 = a1 * a3 * x4 * 1.34414589782e-4
        t283 = a1 * x3 * x4 * 1.32351203486e-4
        t285 = a1 * a3 * x4 * 1.2358782147e-4
        t287 = a2 * a3 * x4 * 1.06745784763e-4
        t288 = a1 * a2 * x4 * 1.05537393767e-4
        t291 = a3 * x3 * x4 * 6.32461827152e-5
        t292 = a1 * a2 * a3 * 5.25555733531e-5
        t293 = a1 * x3 * 5.95973327791e-5
        t294 = a1 * a2 * a3 * 6.42998209881e-6
        t297 = a1 * x3 * x4 * 9.1398973125e-5
        t302 = a1 * a3 * x4 * 3.72242387459e-5
        t304 = a1 * a2 * x4 * 4.40792986049e-5
        t305 = a2 * x3 * x4 * 2.99273960583e-5
        t306 = a1 * a3 * x3 * 5.5707194202e-5
        t313 = a3 * x3 * x4 * 1.00330191585e-4
        t317 = a2 * x3 * x4 * 4.43644704317e-5
        t320 = a1 * a2 * x4 * 2.46113186202e-6
        t321 = a2 * a3 * x3 * 1.06575272976e-5
        t329 = a1 * a3 * x3 * 5.42589328677e-5
        t331 = a2 * a3 * x3 * 5.64253931549e-5
        t335 = a1 * a2 * x4 * 1.41684310565e-5
        t336 = a2 * a3 * x3 * 5.16550489093e-6
        t338 = a1 * a2 * x4 * 2.43165294345e-5
        t341 = a1 * a3 * x3 * 3.60150252688e-5
        t343 = a1 * x3 * x4 * 9.389692779520001e-6
        t345 = a1 * a3 * x3 * 4.5075515113e-5
        t349 = a2 * a3 * x4 * 5.34296252938e-5
        t351 = a1 * a2 * x3 * 1.29856045776e-5
        t352 = a2 * a3 * x4 * 9.61825116559e-5
        t353 = a2 * x3 * x4 * 8.01427664659e-6
        t357 = a2 * a3 * x3 * 1.85393739554e-5
        t358 = a1 * a2 * a3 * 6.14475484874e-6
        t360 = a1 * a2 * a3 * 2.37335360888e-5
        t372 = a1 * a3 * x3 * 6.57098826123e-5
        t373 = a2 * a3 * x4 * 2.1667137862e-5
        t377 = a2 * a3 * x4 * 4.76490358057e-5
        t379 = a1 * x3 * x4 * 3.84970414037e-5
        t380 = a2 * a3 * x4 * 4.26355756734e-5
        t391 = a1 * a3 * x3 * 6.160968428219999e-5
        t393 = a1 * a3 * x4 * 3.08187644432e-5
        t396 = a3 * x3 * x4 * 6.17324415454e-5
        t401 = a1 * a2 * x3 * 3.92142252647e-6
        t406 = a1 * x3 * x4 * 7.76473006891e-6
        t412 = a2 * a3 * x3 * 4.96190134275e-6
        t413 = a1 * a2 * x3 * 2.48229869037e-6
        t417 = a2 * x3 * x4 * 4.9790159405e-6
        t420 = a1 * a2 * a3 * 5.21885290378e-6
        t441 = a1 * a2 * x3 * 1.25878134083e-6
        t451 = a1 * a2 * a3 * 7.59959136882e-6
        t459 = a1 * a2 * x4 * 9.26376304652e-6
        t461 = a1 * a2 * x3 * 7.79432996158e-7
        t463 = a1 * a2 * a3 * 3.14288992641e-6
        t481 = a1 * a2 * x3 * 4.78652535319e-6
        t483 = a2 * a3 * x4 * 2.83256132329e-6
        t486 = a1 * a2 * x3 * 3.03424557409e-6
        t489 = a3 * x3 * x4 * 4.34528193514e-6
        t490 = a1 * a2 * x4 * 3.17798384019e-6
        t495 = a2 * a3 * x3 * 5.5320280049e-6
        t496 = a1 * a2 * a3 * 1.38360209308e-5
        t504 = a1 * a3 * x3 * 6.07671313547e-6
        t517 = a1 * a3 * x4 * 5.23325648442e-6
        t596 = a1 * x3 * x4 * 2.04789347828e-7
        t603 = a2 * a3 * x3 * 2.27145880274e-7
        t16 = -t13
        t18 = t8 * x4 * 7.052387642419999e-5
        t20 = t8 * 5.39593029248e-2
        t31 = -t17
        t34 = -t19
        t41 = -t22
        t42 = -t23
        t47 = t4 * 6.31987723164e-3
        t50 = t8 * 2.04801911724e-1
        t55 = -t27
        t61 = -t28
        t62 = -t32
        t63 = -t33
        t65 = -t35
        t66 = -t37
        t69 = -t40
        t76 = a3 * t8 * 5.38111198598e-5
        t81 = t8 * 1.30055785744e-1
        t83 = -t45
        t84 = -t46
        t89 = -t48
        t92 = -t51
        t95 = -t52
        t98 = -t54
        t105 = t10 * x3 * 7.52204731147e-4
        t106 = -t57
        t107 = -t59
        t108 = -t60
        t124 = a1 * t4 * 1.1937663726e-5
        t126 = -t64
        t127 = -t67
        t128 = -t68
        t130 = t6 * 5.754568323e-4
        t137 = -t71
        t139 = -t74
        t140 = -t75
        t144 = t4 * 9.82985948416e-3
        t145 = t8 * 5.13940448884e-3
        t147 = t9 * 1.03290782173e-4
        t149 = -t77
        t153 = -t79
        t154 = t8 * 2.0025830626e-2
        t155 = -t82
        t156 = t8 * x4 * 1.40362730059e-4
        t157 = t3 * 9.046146530840001e-6
        t158 = -t85
        t159 = t10 * 1.21831786018e-3
        t161 = -t88
        t163 = t4 * 5.42271134101e-3
        t164 = -t90
        t165 = t8 * x4 * 1.07168175489e-4
        t168 = t2 * 1.12090271553e-3
        t169 = -t99
        t170 = -t100
        t171 = -t102
        t172 = -t103
        t174 = t10 * 6.08984754695e-4
        t175 = -t111
        t176 = t11 * 2.89371839376e-5
        t177 = -t113
        t178 = -t114
        t179 = -t115
        t180 = -t116
        t182 = -t117
        t183 = t11 * 2.69827604774e-4
        t184 = -t120
        t185 = -t121
        t186 = -t122
        t190 = t10 * 5.97251695367e-3
        t193 = -t131
        t194 = -t132
        t195 = t4 * 3.24988930899e-3
        t196 = t8 * 1.65248183779e-3
        t198 = -t135
        t199 = -t136
        t200 = t2 * 1.5628017299e-3
        t201 = t6 * 1.33625341063e-3
        t202 = t8 * x4 * 1.32901649937e-4
        t203 = -t138
        t204 = t4 * 1.2805965596e-2
        t205 = t8 * 1.97318670178e-3
        t206 = t11 * 1.22072683394e-4
        t208 = t10 * 4.11992742472e-3
        t209 = t10 * 9.916886660480001e-4
        t210 = t2 * 1.39037305355e-3
        t211 = -t146
        t213 = t6 * 5.5010074549e-3
        t216 = t4 * 1.80335481585e-3
        t217 = -t150
        t218 = -t151
        t219 = a3 * t8 * 4.3464932991e-4
        t221 = t9 * 1.40931894833e-3
        t222 = -t152
        t223 = t6 * x3 * 1.26312151602e-4
        t224 = t6 * 1.32635015136e-3
        t225 = t4 * 3.5570093032e-3
        t227 = t9 * 3.78849923089e-5
        t229 = t11 * 3.04216714324e-4
        t231 = -t160
        t235 = t7 * 1.13441153983e-4
        t236 = t4 * x3 * 6.28273131792e-4
        t237 = -t166
        t238 = t2 * x3 * 6.05073899125e-4
        t239 = a2 * t2 * 1.1956479581e-5
        t240 = t10 * x3 * 1.21472647241e-3
        t241 = t2 * x4 * 1.28874288718e-4
        t242 = t9 * 2.05003203144e-4
        t243 = t6 * 7.02072027561e-4
        t245 = t10 * 4.1162854072e-4
        t246 = t11 * 1.03412675963e-4
        t248 = t2 * 1.9013304948e-4
        t251 = -t181
        t255 = -t188
        t257 = t8 * x4 * 3.59441061589e-4
        t259 = -t192
        t260 = -t197
        t262 = t4 * x4 * 1.59303175014e-5
        t263 = t9 * 1.00732836671e-4
        t264 = a3 * t2 * 2.23315334872e-5
        t268 = t2 * 1.60372723459e-4
        t270 = t2 * 9.2917104633e-4
        t271 = t7 * 1.03562058097e-4
        t272 = t7 * 8.754102341990001e-5
        t274 = t2 * 6.277345594e-4
        t275 = t4 * x3 * 8.28100591414e-4
        t276 = -t212
        t278 = t9 * 7.09354708439e-4
        t279 = t6 * 1.01317853606e-4
        t280 = -t214
        t284 = t6 * 3.34681827909e-4
        t286 = -t220
        t295 = t2 * x3 * 3.5099206498e-4
        t298 = -t232
        t299 = t3 * 1.51020059841e-5
        t300 = t9 * 1.56766020132e-5
        t301 = -t234
        t307 = a3 * t8 * 9.754663935140001e-5
        t308 = t5 * 2.51135239755e-5
        t309 = t10 * x3 * 2.25792537178e-4
        t310 = t4 * x4 * 9.521849626390001e-5
        t311 = t6 * x4 * 7.94547746956e-5
        t312 = t6 * x4 * 8.52778697176e-5
        t314 = a3 * t10 * 1.12231665815e-4
        t315 = a3 * t10 * 6.20504933764e-5
        t316 = a3 * t8 * 7.073224578009999e-5
        t318 = t5 * 7.34354146653e-6
        t319 = t11 * 4.40063617313e-5
        t322 = a1 * t8 * 5.50995372261e-5
        t323 = t11 * 7.75836578662e-5
        t324 = t7 * 2.5915365642e-5
        t325 = a1 * t10 * 4.10731227004e-5
        t327 = t6 * x3 * 1.02727611641e-4
        t328 = t6 * x3 * 4.25308649023e-4
        t332 = t2 * x4 * 1.33972587594e-4
        t333 = -t249
        t334 = -t250
        t337 = t2 * x3 * 1.29432626932e-4
        t339 = t4 * x3 * 1.4675124778e-4
        t340 = -t253
        t342 = t4 * x4 * 6.473365560599999e-5
        t344 = a3 * t10 * 1.44996426069e-4
        t346 = t9 * 2.92989324054e-5
        t347 = t6 * x4 * 1.03594959893e-4
        t348 = a2 * t10 * 2.72227903309e-4
        t350 = a3 * t10 * 1.61417871401e-4
        t354 = a3 * t10 * 9.345717337130001e-5
        t355 = a3 * t10 * 1.15435349679e-4
        t356 = a2 * t10 * 2.60917256284e-4
        t359 = a1 * t10 * 3.97600021476e-4
        t361 = t10 * 7.601160831209999e-5
        t363 = t6 * x4 * 1.38714574279e-4
        t366 = a1 * t8 * 2.14817272479e-4
        t367 = t3 * 1.71004108029e-5
        t368 = a3 * t8 * 9.06036204907e-5
        t369 = t6 * x3 * 1.93003120054e-4
        t370 = a1 * t10 * 2.75388443459e-4
        t371 = t11 * 3.59510177454e-5
        t374 = t3 * 7.867197061660001e-6
        t375 = t5 * 5.36109055066e-6
        t376 = t4 * x3 * 2.09891239473e-5
        t378 = a3 * t2 * 6.33957362584e-5
        t381 = t10 * x3 * 1.64611531125e-4
        t383 = t10 * x3 * 6.9772738326e-4
        t384 = t3 * 9.990001941949999e-6
        t386 = -t281
        t387 = -t283
        t388 = t7 * 2.21176161231e-5
        t390 = a3 * t4 * 1.88478083038e-4
        t392 = t4 * x4 * 5.77712587153e-5
        t394 = t10 * x3 * 2.43466727085e-4
        t395 = t4 * x4 * 2.242343857e-4
        t397 = a2 * t6 * 6.3006936213e-5
        t398 = a1 * t6 * 3.32110186538e-5
        t399 = -t293
        t400 = a1 * t8 * 3.94911493008e-5
        t402 = t8 * x4 * 6.66530891284e-5
        t403 = t4 * x3 * 3.73574277207e-5
        t404 = a2 * t10 * 2.76885952946e-5
        t405 = a3 * t2 * 3.45673048756e-5
        t407 = t8 * x4 * 1.02585496305e-4
        t408 = a2 * t10 * 1.19856848316e-5
        t409 = -t297
        t414 = t7 * 6.35313340411e-6
        t415 = -t302
        t416 = a1 * t6 * 1.68724895371e-5
        t418 = a3 * t4 * 1.35446559586e-5
        t419 = -t305
        t421 = t6 * x3 * 3.5567314113e-5
        t422 = -t306
        t423 = a2 * t6 * 4.24676901128e-5
        t424 = a3 * t8 * 1.3337872761e-5
        t425 = a2 * t6 * 2.50012303044e-5
        t426 = t2 * x3 * 2.99390761191e-5
        t428 = a1 * t4 * 9.321080139299999e-6
        t429 = -t313
        t431 = a3 * t4 * 2.07894884015e-5
        t432 = t2 * x4 * 5.07511921406e-5
        t433 = t7 * 9.07112669551e-6
        t434 = -t317
        t435 = t2 * x4 * 7.02637302885e-5
        t437 = -t320
        t438 = -t321
        t439 = t6 * x4 * 2.53075079856e-5
        t442 = a3 * t10 * 8.00051918073e-5
        t445 = -t329
        t446 = a1 * t4 * 2.72774172798e-5
        t447 = a1 * t10 * 8.55506395071e-5
        t448 = -t335
        t449 = -t336
        t453 = t4 * x4 * 2.60071139593e-5
        t454 = a1 * t4 * 1.36473523476e-5
        t455 = a1 * t8 * 9.088554801139999e-5
        t456 = t8 * x4 * 6.231460432690001e-5
        t457 = t5 * 2.44195571161e-6
        t458 = t3 * 1.18365741353e-5
        t460 = a3 * t2 * 1.17237330687e-4
        t464 = t2 * x3 * 8.2499017313e-6
        t466 = a1 * t8 * 2.55377946574e-5
        t467 = a1 * t10 * 7.219525017019999e-5
        t469 = -t351
        t470 = t6 * x4 * 1.7392651657e-5
        t471 = a1 * t10 * 1.16731675368e-5
        t472 = t4 * x3 * 4.78078140633e-5
        t473 = t5 * 1.85951452574e-6
        t474 = t5 * 1.03059889033e-6
        t475 = t4 * x4 * 5.39974427864e-5
        t476 = a2 * t10 * 7.53529605492e-5
        t477 = t6 * x3 * 2.70738390116e-5
        t478 = t6 * x4 * 7.827807084079999e-5
        t479 = a3 * t2 * 1.91150529583e-5
        t480 = a1 * t6 * 9.497252900449999e-6
        t482 = a2 * t6 * 3.41387099631e-5
        t484 = t10 * x3 * 1.13239568448e-4
        t485 = t4 * x4 * 1.04192888033e-5
        t492 = a1 * t6 * 2.63660360516e-5
        t493 = a1 * t8 * 3.39152242923e-5
        t494 = t4 * x3 * 4.88375742004e-5
        t497 = t3 * 2.03549758143e-6
        t499 = t3 * 6.06705596576e-6
        t502 = a2 * t8 * 3.60362520607e-5
        t503 = t2 * x3 * 4.27773685936e-5
        t505 = -t373
        t506 = -t377
        t507 = a2 * t2 * 4.47393773368e-5
        t508 = a2 * t8 * 2.09152527405e-5
        t509 = -t380
        t510 = a2 * t10 * 3.52662240554e-5
        t513 = t6 * x3 * 1.51539933779e-5
        t514 = a2 * t8 * 2.26308515954e-5
        t516 = t6 * x4 * 1.70791505474e-5
        t518 = a2 * t6 * 2.03900094667e-5
        t519 = -t391
        t521 = t4 * x3 * 2.69993082407e-5
        t522 = t2 * x3 * 1.25750862335e-5
        t523 = a2 * t2 * 1.66299059866e-5
        t525 = a1 * t8 * 7.282845708969999e-5
        t526 = -t396
        t527 = a1 * t10 * 4.18862862212e-6
        t528 = a2 * t8 * 2.03239432422e-5
        t529 = a3 * t4 * 4.61972938211e-5
        t530 = t5 * 1.31659314871e-5
        t531 = a2 * t8 * 1.39933600438e-5
        t533 = t2 * x4 * 1.99095868537e-5
        t534 = a3 * t2 * 1.51225319775e-5
        t535 = a1 * t6 * 8.470473265459999e-6
        t537 = a2 * t8 * 7.54357267849e-6
        t538 = -t406
        t539 = a2 * t10 * 1.24663963884e-5
        t540 = a2 * t2 * 2.51907399473e-6
        t543 = a1 * t4 * 1.05565313587e-5
        t544 = -t413
        t545 = -t417
        t548 = a1 * t6 * 1.50878384357e-5
        t552 = a1 * t6 * 2.80300400073e-6
        t553 = a2 * t6 * 4.40657007211e-6
        t559 = a1 * t10 * 1.19570010971e-5
        t560 = a1 * t8 * 9.47934854242e-6
        t561 = t2 * x3 * 1.46546792862e-5
        t562 = a1 * t4 * 2.33289672416e-6
        t564 = -t451
        t568 = a2 * t2 * 4.79043933582e-6
        t570 = -t459
        t571 = -t461
        t572 = -t463
        t575 = t2 * x4 * 1.44980582922e-5
        t576 = a2 * t6 * 4.82500812522e-6
        t583 = a1 * t4 * 4.77574982414e-6
        t584 = a3 * t4 * 5.29371072727e-6
        t585 = a3 * t8 * 1.28831383278e-5
        t587 = a3 * t2 * 1.1697645426e-5
        t588 = -t483
        t590 = -t486
        t591 = -t490
        t594 = -t496
        t598 = -t504
        t600 = t2 * x4 * 1.25413155144e-5
        t601 = a2 * t2 * 8.460428016170001e-6
        t604 = a2 * t2 * 6.40459631898e-7
        t605 = a1 * t4 * 2.35810406372e-6
        t606 = a1 * t6 * 9.569037004080001e-6
        t608 = t6 * x3 * 1.50395088199e-5
        t611 = a3 * t4 * 3.33425573943e-6
        t612 = t10 * x3 * 1.29752174192e-5
        t627 = a3 * t4 * 4.35882265289e-7
        t628 = a2 * t8 * 5.80742044127e-7
        t630 = -t603
        t632 = t2 * x4 * 1.05618336192e-7
        t86 = -t47
        t143 = -t76
        t187 = -t124
        t207 = -t144
        t226 = -t156
        t230 = -t159
        t233 = -t163
        t247 = -t176
        t252 = -t183
        t256 = -t190
        t265 = -t201
        t266 = -t202
        t269 = -t204
        t273 = -t210
        t277 = -t213
        t282 = -t216
        t289 = -t221
        t290 = -t223
        t296 = -t229
        t303 = -t238
        t326 = -t242
        t330 = -t246
        t362 = -t264
        t364 = -t268
        t365 = -t270
        t382 = -t274
        t385 = -t275
        t389 = -t284
        t410 = -t299
        t411 = -t300
        t427 = -t309
        t430 = -t314
        t436 = -t319
        t440 = -t324
        t443 = -t327
        t444 = -t328
        t450 = -t337
        t452 = -t339
        t462 = -t346
        t465 = -t348
        t468 = -t350
        t487 = -t356
        t488 = -t359
        t491 = -t361
        t498 = -t367
        t500 = -t370
        t501 = -t371
        t511 = -t383
        t512 = -t384
        t515 = -t388
        t520 = -t392
        t524 = -t394
        t532 = -t400
        t536 = -t402
        t541 = -t407
        t542 = -t408
        t546 = -t418
        t547 = -t421
        t549 = -t424
        t550 = -t425
        t551 = -t426
        t554 = -t431
        t555 = -t432
        t556 = -t433
        t557 = -t435
        t558 = -t439
        t563 = -t447
        t565 = -t453
        t566 = -t454
        t567 = -t456
        t569 = -t457
        t573 = -t464
        t574 = -t466
        t577 = -t471
        t578 = -t472
        t579 = -t473
        t580 = -t476
        t581 = -t477
        t582 = -t479
        t586 = -t482
        t589 = -t484
        t592 = -t493
        t593 = -t494
        t595 = -t497
        t597 = -t503
        t599 = -t510
        t602 = -t516
        t607 = -t522
        t609 = -t528
        t610 = -t531
        t613 = -t534
        t614 = -t535
        t615 = -t537
        t616 = -t540
        t617 = -t543
        t618 = -t548
        t619 = -t552
        t620 = -t553
        t621 = -t560
        t622 = -t562
        t623 = -t568
        t624 = -t575
        t625 = -t576
        t626 = -t584
        t629 = -t601
        t631 = -t611
        t633 = -t627
        t634 = -t628
        t635 = t39+t42+t50+t55+t70+t143+t164+t168+t179+t195+t208+t243+t271+t333+t338+t372+t378+t386+t397+t442+t465+t502+t523+t526+t529+t530+t571-5.439022618329999e-1
        t636 = t26+t43+t72+t104+t105+t107+t118+t162+t171+t189+t241+t252+t266+t280+t287+t290+t310+t347+t360+t398+t412+t446+t450+t452+t455+t462+t488+t512
        t637 = t31+t58+t65+t83+t161+t175+t177+t178+t187+t198+t226+t236+t240+t278+t292+t295+t312+t342+t349+t366+t369+t379+t410+t436+t438+t500+t557+t614
        t638 = t80+t84+t108+t125+t145+t155+t191+t245+t254+t265+t267+t272+t282+t288+t308+t353+t355+t368+t382+t405+t423+t445+t481+t487+t507+t554+t610-8.016580322520001e-2
        t639 = t15+t16+t18+t53+t109+t141+t148+t203+t251+t258+t289+t294+t303+t322+t325+t352+t357+t385+t416+t444+t478+t485+t499+t501+t511+t538+t566+t600
        t640 = t66+t81+t98+t119+t130+t172+t174+t193+t218+t228+t239+t269+t285+t304+t334+t354+t365+t375+t414+t469+t508+t519+t542+t549+t582+t586+t631-2.84992229764e-1
        t641 = t34+t36+t49+t91+t127+t140+t157+t158+t170+t217+t247+t257+t261+t326+t331+t343+t358+t381+t403+t443+t492+t520+t573+t577+t583+t592+t602+t624
        t642 = t12+t24+t96+t106+t128+t142+t165+t169+t231+t260+t263+t323+t332+t340+t363+t374+t395+t467+t480+t506+t513+t521+t532+t561+t594+t605+t612+t630
        t643 = t30+t73+t95+t97+t137+t154+t207+t230+t244+t273+t277+t291+t318+t345+t399+t401+t415+t440+t468+t518+t585+t587+t591+t599+t609+t626+t629+6.616045960319999e-2
        t644 = t14+t20+t21+t93+t149+t180+t200+t233+t256+t259+t279+t301+t316+t341+t430+t434+t437+t441+t474+t489+t515+t580+t604+t613+t625+t633+t634-1.6763189743e-2
        t645 = t41+t92+t101+t186+t196+t199+t219+t224+t225+t235+t237+t248+t298+t344+t390+t393+t404+t422+t460+t491+t545+t550+t569+t570+t590+t615+t623+1.14922869933e-1
        t646 = t38+t62+t86+t123+t133+t134+t205+t209+t286+t307+t315+t362+t364+t389+t419+t429+t448+t514+t517+t539+t544+t546+t556+t579+t598+t616+t620-2.59567290295e-2
        t647 = t44+t56+t69+t89+t110+t112+t126+t147+t184+t211+t296+t311+t387+t428+t458+t475+t495+t509+t524+t533+t551+t563+t564+t567+t574+t581+t593+t606
        t648 = t25+t61+t87+t167+t185+t194+t206+t215+t222+t227+t276+t376+t409+t427+t449+t498+t505+t525+t541+t555+t558+t559+t565+t572+t607+t608+t617+t618
        t649 = t29+t63+t78+t94+t129+t139+t153+t173+t182+t255+t262+t330+t411+t420+t470+t527+t536+t547+t578+t588+t589+t595+t596+t597+t619+t621+t622+t632
        et1 = a2 * (-7.36541916208e-2)+a3 * 4.37065930151e-2-t2 * 2.4117409626e-3-t4 * 1.95649478232e-2+t5 * 7.827115848710001e-6
        et2 = t6 * (-3.64303532911e-4)+t7 * 7.07139944968e-5+t8 * 5.93719358331e-3-t10 * 9.58328796797e-4+a2 * a3 * 1.60398397133e-3
        et3 = a2 * t2 * 4.71167474439e-5+a3 * t2 * 2.76349728615e-5+a3 * t4 * 1.66861808107e-5+a2 * t6 * 3.52238768929e-5
        et4 = a2 * t8 * 1.402949812e-5-a3 * t8 * 9.09093895607e-5-a2 * t10 * 2.55259519827e-4-a3 * t10 * 7.971899786179999e-6
        et5 = a1 * x3 * (-7.06486767223e-3)+a1 * x4 * 6.82191709175e-4-x3 * x4 * 3.95172782656e-3-a1 * a2 * x3 * 3.81621835449e-5
        et6 = a1 * a2 * x4 * 5.59478055992e-6+a1 * a3 * x3 * 4.87199885814e-5-a1 * a3 * x4 * 4.56718187312e-5-a2 * x3 * x4 * 3.36827426871e-5
        et7 = a3 * x3 * x4 * (-1.14566417752e-3)+5.62935974987e-1
        et8 = a2 * (-5.96067274506e-2)+a3 * 2.81158449801e-2+t2 * 1.29260953432e-3-t4 * 6.10443954434e-2+t5 * 5.66828950528e-6
        et9 = t6 * 1.01092148461e-3+t7 * 1.09845913484e-5+t8 * 8.6942626412e-2+t10 * 1.23302213011e-2-a2 * a3 * 5.05747042863e-3
        et10 = a2 * t2 * 1.99361493339e-5-a3 * t2 * 2.0490358176e-5-a3 * t4 * 6.50112186938e-6-a2 * t6 * 6.688175317680001e-5
        et11 = a2 * t8 * (-1.62000514046e-4)+a3 * t8 * 5.14424875195e-5+a2 * t10 * 2.09057534265e-4+a3 * t10 * 8.66810815253e-5
        et12 = a1 * x3 * (-9.82933674709e-3)+a1 * x4 * 5.93488576549e-3-x3 * x4 * 3.65713335401e-2+a1 * a2 * x3 * 1.64716520728e-5
        et13 = a1 * a2 * x4 * 1.02749819118e-4-a1 * a3 * x3 * 3.91867097967e-5-a1 * a3 * x4 * 1.51447210465e-5-a2 * x3 * x4 * 9.47346405975e-5
        et14 = a3 * x3 * x4 * (-8.45115047797e-4)+2.36440475198e-1
        et15 = a2 * (-1.32204777622e-2)+a3 * 4.51247341589e-4+t2 * 6.422192268849999e-5+t4 * 6.32575965989e-3+t5 * 2.84035911443e-6
        et16 = t6 * 4.41314172194e-4+t7 * 1.60292102408e-5+t8 * 7.1079498001e-4-t10 * 9.330085723939999e-5-a2 * a3 * 1.21010116418e-3
        et17 = a2 * t2 * 1.36008677289e-5+a3 * t2 * 2.75517406256e-5+a3 * t4 * 5.62030680993e-6+a2 * t6 * 5.25063639387e-6
        et18 = a2 * t8 * 1.24043234968e-5-a3 * t8 * 2.45838544237e-5-a2 * t10 * 4.92218300922e-5+a3 * t10 * 6.13912809074e-5
        et19 = a1 * x3 * (-4.38019516006e-4)+a1 * x4 * 5.50253626366e-4-x3 * x4 * 2.20714694006e-3+a1 * a2 * x3 * 5.55445133947e-6
        et20 = a1 * a2 * x4 * 2.6610339078e-5-a1 * a3 * x3 * 1.73333551269e-5+a1 * a3 * x4 * 1.62943709608e-5+a2 * x3 * x4 * 3.82089481539e-6
        et21 = a3 * x3 * x4 * (-5.6039358904e-5)+4.14827692978e-2
        et22 = a2 * 3.35510941412e-2-a3 * 3.95563535148e-2+t2 * 5.78409604294e-4+t4 * 8.465680343709999e-3+t5 * 4.26672301844e-6
        et23 = t6 * 4.47374214769e-3+t7 * 7.00180693211e-5+t8 * 2.46624089857e-2-t10 * 3.69911954601e-3-a2 * a3 * 8.649441943959999e-3
        et24 = a2 * t2 * (-7.05294846236e-6)-a3 * t2 * 3.64073484725e-5+a3 * t4 * 2.0059415919e-5+a2 * t6 * 2.23873727091e-5
        et25 = a2 * t8 * 1.48826133725e-5+a3 * t8 * 1.61203242956e-4-a2 * t10 * 1.05862165923e-4+a3 * t10 * 3.56215817076e-4
        et26 = a1 * x3 * 1.3662068163e-2+a1 * x4 * 1.48828625816e-2-x3 * x4 * 1.28498633547e-1-a1 * a2 * x3 * 1.91544861427e-7
        et27 = a1 * a2 * x4 * (-6.31308858128e-8)+a1 * a3 * x3 * 1.12217122613e-4-a1 * a3 * x4 * 2.23015502985e-4-a2 * x3 * x4 * 1.10343930031e-5
        et28 = a3 * x3 * x4 * (-7.32440336365e-4)+8.89203257772e-1
        et29 = a2 * 9.27253093667e-2-a3 * 6.22328441927e-2+t2 * 5.62320084365e-4+t4 * 7.57363068222e-3+t5 * 1.5579579457e-5
        et30 = t6 * (-7.13978799009e-4)-t7 * 1.91756318876e-5-t8 * 4.69495772061e-2+t10 * 2.11912723349e-2+a2 * a3 * 4.69938757016e-3
        et31 = a2 * t2 * (-1.27698509342e-5)+a3 * t2 * 2.26210960189e-6-a3 * t4 * 2.088222264e-5+a2 * t6 * 1.31307120862e-5
        et32 = a2 * t8 * 4.35540637545e-5+a3 * t8 * 8.264202566720001e-6-a2 * t10 * 4.77288078874e-5+a3 * t10 * 7.43751363694e-5
        et33 = a1 * x3 * 1.32169097222e-2+a1 * x4 * 4.48213924384e-3-x3 * x4 * 1.6975661107e-4+a1 * a2 * x3 * 1.80757527541e-5-a1 * a2 * x4 * 1.81711280116e-6
        et34 = a1 * a3 * x3 * (-4.45186817911e-6)-a1 * a3 * x4 * 5.36801575668e-6-a2 * x3 * x4 * 1.22212949409e-5+a3 * x3 * x4 * 1.89122315364e-4
        et35 = 7.36101752969e-1
        et36 = a2 * (-3.58616341318e-2)+a3 * 8.29096467589e-3+t2 * 1.5348931273e-3+t4 * 3.00508328641e-2+t5 * 3.01822227879e-6
        et37 = t6 * 5.06557279928e-3+t7 * 1.2046156666e-5-t8 * 3.4644953077e-2-t10 * 3.01319484271e-4+a2 * a3 * 1.0819825364e-3
        et38 = a2 * t2 * (-5.79402644495e-6)+a3 * t2 * 2.10239900141e-5-a3 * t4 * 9.47130640858e-6+a2 * t6 * 1.04101714035e-5
        et39 = a2 * t8 * 2.61412860711e-5+a3 * t8 * 3.11491528454e-6-a2 * t10 * 5.08579779747e-5-a3 * t10 * 1.32953954658e-6
        et40 = a1 * x3 * (-6.71328347445e-4)+a1 * x4 * 2.0149989713e-3+x3 * x4 * 1.59477957798e-2-a1 * a2 * x3 * 2.14315643675e-5
        et41 = a1 * a2 * x4 * (-8.087616013039999e-7)-a1 * a3 * x3 * 5.64406753515e-6+a1 * a3 * x4 * 2.37394824333e-5+a2 * x3 * x4 * 2.54731605306e-6
        et42 = a3 * x3 * x4 * 7.64804687346e-5+1.31012163315
        W_fcn = np.reshape([et1+et2+et3+et4+et5+et6+et7,t636,t646,t635,t639,t644,t636,et8+et9+et10+et11+et12+et13+et14,t642,t637,t640,t647,t646,t642,et15+et16+et17+et18+et19+et20+et21,t645,t648,t638,t635,t637,t645,et22+et23+et24+et25+et26+et27+et28,t641,t643,t639,t640,t648,t641,et29+et30+et31+et32+et33+et34+et35,t649,t644,t647,t638,t643,t649,et36+et37+et38+et39+et40+et41+et42],(6,6))
        return W_fcn

    def dW_dphi_fcn(self, x, a):
        #dW_dphi
        #    dW_dphi = dW_dphi(IN1,IN2)
        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    24-Feb-2026 12:05:58

        a1 = a[0]
        a2 = a[1]
        a3 = a[2]
        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a2 ** 2
        t4 = a3 ** 2
        t5 = x3 ** 2
        t6 = x4 ** 2
        t7 = x4 * 5.16654382872469e-2
        t8 = a1 * x4 * 1.323512034861161e-4
        t9 = x3 * 4.096038234475311e-1
        t10 = a1 * 2.225749550601661e-3
        t11 = x3 * 1.079186058495476e-1
        t12 = x3 * 2.601115714887824e-1
        t13 = x3 * 1.027880897768429e-2
        t14 = a3 * 1.261474834321218e-2
        t15 = x4 * 1.956171734859163e-2
        t17 = a2 * 1.455580502263925e-2
        t18 = x4 * 2.250685239839124e-2
        t19 = x4 * 1.287254188687925e-2
        t20 = x4 * 3.603051543467567e-4
        t21 = x3 * 4.005166125198047e-2
        t22 = a1 * 1.394104899430828e-2
        t23 = x4 * 1.849248797351508e-2
        t24 = a3 * 6.679833601939172e-3
        t25 = a2 * 2.868300766725062e-2
        t27 = a1 * x4 * 3.849704140366649e-5
        t29 = a2 * 1.350257091937334e-2
        t30 = a3 * x3 * 1.950932787027999e-4
        t31 = a1 * 1.119383473632318e-3
        t32 = x4 * 1.469103515304812e-2
        t33 = a1 * x3 * 5.107558931471121e-5
        t35 = a2 * 2.928550469903756e-3
        t36 = a3 * 1.395977747748336e-2
        t37 = a2 * 2.488053643575947e-3
        t38 = x3 * 3.946373403555904e-3
        t40 = a3 * 4.744599670250461e-3
        t41 = a3 * 8.343846478999065e-4
        t42 = a2 * 7.680392689150805e-3
        t43 = x3 * 3.304963675575277e-3
        t46 = a3 * 9.523034373174978e-3
        t47 = a1 * 6.777571586165662e-4
        t48 = a2 * 1.347307901080429e-2
        t49 = a3 * 2.460260298444739e-3
        t50 = a2 * 6.644621968634411e-3
        t51 = a2 * x4 * 7.721288568664415e-5
        t53 = a3 * x4 * 4.345281935137833e-6
        t54 = a1 * 7.221551285611115e-4
        t55 = a3 * 9.675298179337204e-4
        t57 = a1 * 4.288863725149308e-4
        t60 = a1 * x4 * 2.822974835575876e-4
        t67 = a2 * x3 * 4.526170319088714e-5
        t68 = a1 * x3 * 1.817710960228413e-4
        t69 = x3 * x4 * 1.246292086537906e-4
        t71 = x3 * x4 * 1.410477528483064e-4
        t72 = a2 * x3 * 7.207250412140097e-5
        t73 = a1 * a2 * 7.794329961581855e-7
        t74 = a1 * x3 * 7.898229860154747e-5
        t75 = a1 * 5.959733277905678e-5
        t76 = a1 * x3 * 4.296345449581593e-4
        t77 = x3 * x4 * 2.143363509785068e-4
        t78 = a2 * x4 * 6.221739244062027e-5
        t79 = a3 * x3 * 1.812072409814664e-4
        t80 = a3 * x4 * 2.625101265547977e-4
        t81 = x3 * x4 * 1.333061782567567e-4
        t82 = a3 * x4 * 1.003301915851869e-4
        t83 = x3 * x4 * 2.051709926109352e-4
        t85 = a3 * x4 * 1.538791132481895e-4
        t86 = x3 * x4 * 2.658032998743449e-4
        t87 = a2 * x3 * 1.161484088254448e-6
        t88 = a1 * a3 * 5.425893286769079e-5
        t90 = a3 * x4 * 6.173244154541164e-5
        t91 = a3 * x3 * 8.692986598191477e-4
        t92 = a1 * x3 * 1.456569141794116e-4
        t93 = a3 * x4 * 4.193628421669213e-4
        t94 = x3 * x4 * 7.188821231783059e-4
        t95 = a3 * x3 * 1.41464491560171e-4
        t96 = x3 * x4 * 2.80725460118108e-4
        t97 = a2 * x4 * 4.436447043168475e-5
        t99 = a1 * a3 * 4.507551511296527e-5
        t101 = a1 * a2 * 1.298560457759987e-5
        t102 = a1 * x3 * 1.895869708484578e-5
        t103 = a2 * a3 * 1.853937395538713e-5
        t104 = a2 * a3 * 5.532028004895475e-6
        t105 = a3 * x3 * 1.076222397196371e-4
        t106 = a1 * a2 * 3.921422526469855e-6
        t110 = a1 * a3 * 6.570988261230319e-5
        t115 = a3 * x4 * 6.324618271523717e-5
        t116 = a2 * a3 * 1.321681312877855e-5
        t118 = a1 * x4 * 7.764730068913363e-6
        t120 = a2 * x3 * 4.183050548095279e-5
        t121 = a1 * a3 * 6.1609684282229e-5
        t122 = a1 * x3 * 6.783044858463297e-5
        t124 = a3 * x3 * 2.66757455219291e-5
        t129 = a2 * x3 * 2.798672008752094e-5
        t131 = a1 * x4 * 9.139897312498338e-5
        t135 = a1 * x4 * 6.273083003586155e-5
        t136 = a1 * a3 * 6.076713135471063e-6
        t138 = a3 * x3 * 2.576627665551694e-5
        t139 = a1 * a3 * 5.570719420196753e-5
        t145 = a2 * a3 * 5.642539315491211e-5
        t146 = a1 * x3 * 1.10199074452139e-4
        t147 = a2 * x4 * 4.979015940501063e-6
        t151 = a2 * x3 * 1.508714535697785e-5
        t152 = a2 * x3 * 4.064788648438102e-5
        t153 = a2 * x4 * 2.992739605832603e-5
        t154 = a1 * a3 * 3.601502526880107e-5
        t156 = a2 * x4 * 8.060426722306369e-5
        t157 = a2 * x4 * 8.014276646591743e-6
        t167 = a1 * a2 * 4.786525353192545e-6
        t168 = a2 * a3 * 4.961901342749391e-6
        t169 = a1 * a2 * 2.482298690367733e-6
        t172 = a1 * a2 * 3.034245574085445e-6
        t187 = a2 * a3 * 1.065752729756403e-5
        t195 = a2 * a3 * 5.165504890926678e-6
        t200 = a1 * x4 * 9.389692779518315e-6
        t201 = a1 * a2 * 1.258781340826787e-6
        t217 = a1 * x4 * 2.047893478278068e-7
        t220 = a2 * a3 * 2.271458802739849e-7
        t16 = -t8
        t26 = t2 * 6.050738991246266e-4
        t28 = -t14
        t34 = -t17
        t39 = -t19
        t44 = -t22
        t45 = -t23
        t56 = -t33
        t58 = -t36
        t59 = -t40
        t61 = -t41
        t62 = t2 * 1.294326269317462e-4
        t63 = -t46
        t64 = -t47
        t65 = -t48
        t66 = -t50
        t70 = -t57
        t89 = t6 * 1.214726472412145e-3
        t98 = t5 * 1.13654976926577e-4
        t100 = -t69
        t107 = t4 * 1.26312151601833e-4
        t108 = t4 * 1.930031200537077e-4
        t109 = t5 * 4.227956844995316e-3
        t111 = t6 * 1.132395684475615e-4
        t112 = t6 * 2.257925371782617e-4
        t113 = -t73
        t114 = t6 * 6.977273832604805e-4
        t117 = t3 * 6.282731317918817e-4
        t119 = -t74
        t123 = t6 * 2.434667270852689e-4
        t125 = t6 * 1.646115311253469e-4
        t126 = -t75
        t127 = t2 * 3.509920649803039e-4
        t128 = t6 * 7.522047311465313e-4
        t130 = t3 * 8.281005914144078e-4
        t132 = -t80
        t133 = -t81
        t134 = -t82
        t137 = -t83
        t140 = -t86
        t141 = -t87
        t142 = -t88
        t143 = -t90
        t144 = t4 * 4.253086490226078e-4
        t148 = -t93
        t149 = t5 * 3.021985100118013e-4
        t150 = t3 * 1.467512477796986e-4
        t155 = -t96
        t158 = t2 * 1.46546792861931e-5
        t159 = -t97
        t160 = t4 * 1.027276116407128e-4
        t161 = t2 * 8.249901731304838e-6
        t162 = -t101
        t163 = -t102
        t164 = t3 * 4.78078140632628e-5
        t165 = t5 * 2.128064125317837e-3
        t166 = t4 * 2.707383901157174e-5
        t170 = -t105
        t174 = t2 * 4.27773685935991e-5
        t178 = -t116
        t179 = t3 * 4.883757420040699e-5
        t180 = -t118
        t181 = -t121
        t182 = -t122
        t183 = t3 * 2.699930824067132e-5
        t184 = t2 * 1.257508623349851e-5
        t186 = -t124
        t188 = t5 * 6.150096094313921e-4
        t189 = t3 * 3.735742772065925e-5
        t190 = -t129
        t192 = -t131
        t193 = -t135
        t194 = -t136
        t196 = t4 * 3.556731411300638e-5
        t197 = t3 * 2.098912394729987e-5
        t198 = -t139
        t199 = t2 * 2.993907611912289e-5
        t203 = -t147
        t205 = -t151
        t206 = -t152
        t207 = -t153
        t208 = -t156
        t211 = t4 * 1.515399337787478e-5
        t213 = t5 * 8.789679721608524e-5
        t215 = -t169
        t216 = -t172
        t222 = t4 * 1.503950881990918e-5
        t223 = t6 * 1.297521741918497e-5
        t224 = -t187
        t226 = t5 * 3.098723465182694e-4
        t227 = -t195
        t230 = t5 * 4.702980603946152e-5
        t232 = -t220
        t52 = -t26
        t84 = -t62
        t171 = -t107
        t173 = -t109
        t175 = -t111
        t176 = -t112
        t177 = -t114
        t185 = -t123
        t191 = -t130
        t202 = -t144
        t204 = -t150
        t209 = -t160
        t210 = -t161
        t212 = -t164
        t214 = -t166
        t218 = -t174
        t219 = -t179
        t221 = -t184
        t225 = -t188
        t228 = -t196
        t229 = -t199
        t231 = -t213
        t233 = -t230
        t234 = t11+t18+t53+t64+t95+t141+t154+t159+t201
        t235 = t7+t21+t51+t99+t106+t115+t126+t138+t206
        t236 = t20+t30+t31+t38+t67+t134+t194+t207+t215
        t237 = t10+t12+t39+t78+t120+t148+t162+t181+t186
        t238 = t9+t32+t44+t72+t110+t113+t143+t170+t208
        t239 = t13+t15+t54+t79+t85+t142+t157+t167+t190
        t240 = t43+t45+t70+t91+t132+t198+t203+t205+t216
        t241 = t27+t28+t66+t76+t89+t108+t117+t127+t155+t165+t224-2.960895421202238e-1
        t247 = t35+t55+t77+t119+t149+t158+t183+t193+t211+t223+t232-7.412727038729121e-3
        t242 = t37+t49+t52+t71+t103+t146+t173+t177+t180+t191+t202+4.61435080364708e-1
        t243 = t24+t60+t65+t68+t84+t128+t140+t168+t171+t204+t231-2.525666583524196e-3
        t244 = t16+t25+t56+t58+t100+t104+t185+t214+t219+t226+t229-5.707260353133937e-2
        t245 = t42+t61+t92+t98+t137+t176+t192+t197+t221+t222+t227+1.612610065170019e-2
        t246 = t34+t63+t94+t125+t145+t182+t189+t200+t209+t210+t225-4.141456341458857e-3
        t248 = t29+t59+t133+t163+t175+t178+t212+t217+t218+t228+t233-1.900420556776521e-2
        et1 = a1 * (-7.064867672233546e-3)+x3 * 1.187438716662303e-2-x4 * 3.951727826559497e-3-a1 * a2 * 3.816218354486824e-5+a1 * a3 * 4.871998858139492e-5
        et2 = a2 * x3 * 2.805899624004227e-5-a2 * x4 * 3.368274268706217e-5-a3 * x3 * 1.818187791214784e-4-a3 * x4 * 1.145664177521338e-3
        et3 = a1 * (-9.829336747093582e-3)+x3 * 1.738852528240998e-1-x4 * 3.65713335401095e-2+a1 * a2 * 1.647165207278163e-5-a1 * a3 * 3.918670979670312e-5
        et4 = a2 * x3 * (-3.240010280914994e-4)-a2 * x4 * 9.473464059751308e-5+a3 * x3 * 1.028849750390846e-4-a3 * x4 * 8.451150477966313e-4
        et5 = a1 * (-4.380195160061657e-4)+x3 * 1.42158996001956e-3-x4 * 2.207146940064599e-3+a1 * a2 * 5.554451339473293e-6-a1 * a3 * 1.733335512688493e-5
        et6 = a2 * x3 * 2.48086469935859e-5+a2 * x4 * 3.820894815388533e-6-a3 * x3 * 4.916770884732793e-5-a3 * x4 * 5.60393589040494e-5
        et7 = a1 * 1.366206816299177e-2+x3 * 4.932481797132648e-2-x4 * 1.284986335471678e-1-a1 * a2 * 1.915448614273191e-7+a1 * a3 * 1.122171226128688e-4
        et8 = a2 * x3 * 2.976522674500685e-5-a2 * x4 * 1.103439300313224e-5+a3 * x3 * 3.224064859113143e-4-a3 * x4 * 7.324403363652528e-4
        et9 = a1 * 1.321690972221742e-2-x3 * 9.389915441218395e-2-x4 * 1.697566110695159e-4+a1 * a2 * 1.807575275406591e-5-a1 * a3 * 4.45186817910887e-6
        et10 = a2 * x3 * 8.710812750897123e-5-a2 * x4 * 1.222129494087501e-5+a3 * x3 * 1.652840513343898e-5+a3 * x4 * 1.891223153640809e-4
        et11 = a1 * (-6.713283474447665e-4)-x3 * 6.92899061540624e-2+x4 * 1.594779577977693e-2-a1 * a2 * 2.143156436752165e-5-a1 * a3 * 5.644067535146321e-6
        et12 = a2 * x3 * 5.22825721422928e-5+a2 * x4 * 2.547316053062041e-6+a3 * x3 * 6.229830569077696e-6+a3 * x4 * 7.648046873458211e-5
        dW_dphi = np.reshape([et1+et2,t243,t236,t238,t242,t234,t243,et3+et4,t247,t241,t237,t244,t236,t247,et5+et6,t240,t245,t239,t238,t241,t240,et7+et8,t246,t235,t242,t237,t245,t246,et9+et10,t248,t234,t244,t239,t235,t248,et11+et12],(6,6))

        return dW_dphi
    
    def dW_dvx_fcn(self, x, a):
        #dW_dvx
        #    dW_dvx = dW_dvx(IN1,IN2)
        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    24-Feb-2026 12:05:59

        a1 = a[0]
        a2 = a[1]
        a3 = a[2]
        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a2 ** 2
        t4 = a3 ** 2
        t5 = x3 ** 2
        t6 = x4 ** 2
        t7 = x3 * 5.16654382872469e-2
        t8 = a1 * x3 * 1.323512034861161e-4
        t9 = x3 * 1.956171734859163e-2
        t11 = x3 * 2.250685239839124e-2
        t12 = x4 * 8.23985484943978e-3
        t13 = x4 * 1.194503390733347e-2
        t14 = x3 * 1.287254188687925e-2
        t15 = x3 * 3.603051543467567e-4
        t16 = x4 * 8.232570814401142e-4
        t17 = a2 * 1.820885998119711e-2
        t18 = x3 * 1.849248797351508e-2
        t19 = a2 * 9.340139044743925e-3
        t20 = a3 * 8.185180182837971e-3
        t21 = a2 * 6.439478192723586e-3
        t22 = a1 * 3.152182909947604e-3
        t23 = a1 * x3 * 3.849704140366649e-5
        t24 = x3 * 1.469103515304812e-2
        t25 = a2 * 3.779524930977533e-3
        t26 = a1 * 2.301371769593907e-3
        t27 = a2 * 3.080230695512382e-3
        t28 = a1 * 1.769891259920849e-3
        t29 = a1 * 1.14039065757872e-3
        t31 = a2 * 5.160062162195848e-3
        t32 = x4 * 1.983377332095665e-3
        t35 = a3 * 3.599598664009162e-3
        t36 = a3 * 1.607646851388347e-3
        t37 = a3 * 2.960189946830549e-3
        t38 = x4 * 1.217969509390063e-3
        t40 = a3 * 5.172824677050956e-4
        t41 = x4 * 2.436635720354349e-3
        t42 = a1 * 6.813935839314308e-3
        t43 = a2 * a3 * 4.263557567343933e-5
        t44 = a3 * 5.099177223396889e-4
        t46 = a3 * 1.849085185151516e-3
        t47 = a1 * x4 * 1.711012790142517e-4
        t49 = a1 * 2.883911422705963e-3
        t50 = a2 * x3 * 7.721288568664415e-5
        t51 = a3 * x4 * 2.308706993585995e-4
        t53 = a2 * 6.793156588558632e-4
        t55 = a3 * x3 * 4.345281935137833e-6
        t57 = a2 * 4.63686103144533e-4
        t58 = a1 * 2.609792569790674e-4
        t59 = a2 * x4 * 5.444558066188215e-4
        t64 = a1 * x4 * 5.507768869177172e-4
        t65 = x3 * x4 * 2.26479136895123e-4
        t67 = x3 * x4 * 1.395454766520961e-3
        t68 = a1 * x3 * 2.822974835575876e-4
        t71 = x4 * 1.520232166242192e-4
        t73 = x3 * x4 * 1.504409462293063e-3
        t77 = a2 * x4 * 2.493279277686924e-5
        t78 = a1 * x4 * 7.952000429512502e-4
        t80 = x3 * x4 * 2.42945294482429e-3
        t81 = a3 * 3.861380307594414e-4
        t82 = a3 * x4 * 2.899928521374717e-4
        t87 = a2 * x4 * 1.507059210984528e-4
        t88 = a3 * x4 * 1.869143467426692e-4
        t89 = a2 * a3 * 2.03809951337215e-4
        t90 = a2 * x4 * 5.218345125671938e-4
        t93 = a1 * a3 * 1.235878214702392e-4
        t94 = x3 * x4 * 4.515850743565235e-4
        t96 = a1 * x4 * 1.443905003403241e-4
        t97 = a2 * x3 * 6.221739244062027e-5
        t98 = a3 * x4 * 2.2446333162945e-4
        t99 = x3 * x4 * 4.869334541705378e-4
        t100 = a3 * x4 * 1.24100986752858e-4
        t102 = x3 * x4 * 3.292230622506937e-4
        t103 = a2 * a3 * 9.618251165587616e-5
        t104 = a3 * x3 * 2.625101265547977e-4
        t105 = a1 * x4 * 8.214624540077491e-5
        t106 = a1 * a3 * 4.744256543512006e-5
        t107 = a1 * a3 * 1.344145897822859e-4
        t108 = a3 * x3 * 1.003301915851869e-4
        t109 = a3 * x4 * 3.228357428010118e-4
        t110 = a3 * x3 * 1.538791132481895e-4
        t112 = a2 * x4 * 7.053244811084373e-5
        t113 = a2 * a3 * 1.067457847629088e-4
        t114 = a3 * x3 * 6.173244154541164e-5
        t115 = a3 * x3 * 4.193628421669213e-4
        t116 = a3 * x4 * 1.600103836146797e-4
        t118 = a2 * x3 * 4.436447043168475e-5
        t119 = a1 * a3 * 1.805148966364645e-5
        t120 = a2 * a3 * 5.342962529383422e-5
        t121 = a2 * x4 * 5.537719058928735e-5
        t122 = a1 * x4 * 2.334633507366329e-5
        t123 = a2 * x4 * 2.397136966324977e-5
        t125 = a1 * a3 * 3.722423874590391e-5
        t126 = a1 * a2 * 4.407929860492906e-5
        t127 = a1 * a2 * 1.416843105650696e-5
        t129 = a1 * a2 * 2.431652943453245e-5
        t130 = a2 * a3 * 4.764903580573234e-5
        t131 = a3 * x3 * 6.324618271523717e-5
        t133 = a1 * x3 * 7.764730068913363e-6
        t135 = a2 * a3 * 2.166713786198809e-5
        t136 = a1 * a2 * 3.177983840193874e-6
        t139 = a1 * x4 * 8.377257244234267e-6
        t141 = x3 * x4 * 2.595043483836993e-5
        t142 = a1 * x3 * 9.139897312498338e-5
        t147 = a1 * x3 * 6.273083003586155e-5
        t150 = a1 * a2 * 1.055373937665878e-4
        t153 = a1 * a3 * 3.081876444321027e-5
        t160 = a2 * x3 * 4.979015940501063e-6
        t162 = a1 * x4 * 2.391400219423755e-5
        t163 = a2 * x3 * 2.992739605832603e-5
        t164 = a2 * x3 * 8.060426722306369e-5
        t165 = a2 * x3 * 8.014276646591743e-6
        t167 = a1 * a2 * 9.263763046520372e-6
        t180 = a1 * a3 * 5.233256484416083e-6
        t191 = a2 * a3 * 2.832561323293555e-6
        t195 = a1 * x3 * 9.389692779518315e-6
        t204 = a1 * a2 * 2.461131862023077e-6
        t212 = a1 * x3 * 2.047893478278068e-7
        t10 = -t8
        t30 = t3 * 1.593031750138103e-5
        t33 = -t13
        t34 = -t14
        t39 = -t17
        t45 = -t18
        t48 = -t19
        t52 = -t21
        t54 = t6 * 9.12650142971044e-4
        t56 = -t22
        t60 = -t25
        t61 = -t26
        t62 = -t28
        t63 = -t29
        t66 = t6 * 2.327509735985671e-4
        t69 = -t35
        t70 = -t36
        t72 = -t40
        t74 = -t41
        t75 = -t42
        t76 = -t43
        t79 = -t47
        t84 = t2 * 1.339725875941797e-4
        t85 = -t58
        t86 = -t59
        t91 = -t64
        t92 = -t65
        t95 = -t67
        t101 = -t71
        t111 = -t78
        t117 = t3 * 2.242343856996675e-4
        t124 = -t87
        t128 = -t90
        t132 = t4 * 1.387145742793439e-4
        t134 = -t94
        t137 = -t98
        t138 = -t99
        t140 = t3 * 6.473365560597237e-5
        t143 = -t104
        t144 = -t106
        t145 = -t107
        t146 = -t108
        t148 = t5 * 1.329016499371725e-4
        t149 = -t109
        t151 = t6 * 3.662180501811226e-4
        t152 = -t112
        t154 = t5 * 3.594410615891529e-4
        t155 = t2 * 1.288742887179122e-4
        t156 = -t114
        t157 = t6 * 1.320190851937933e-4
        t158 = t5 * 1.40362730059054e-4
        t159 = t6 * 1.078530532362073e-4
        t161 = -t115
        t166 = -t118
        t168 = t4 * 1.739265165699107e-5
        t169 = t3 * 5.39974427863768e-5
        t170 = t4 * 7.827807084081249e-5
        t171 = -t122
        t172 = t5 * 7.05238764241532e-5
        t173 = -t123
        t174 = -t125
        t175 = -t127
        t176 = -t130
        t177 = t3 * 2.600711395926219e-5
        t178 = -t133
        t179 = t4 * 1.707915054742443e-5
        t181 = t6 * 8.094828143207301e-4
        t182 = t3 * 9.521849626392325e-5
        t183 = t5 * 1.071681754892534e-4
        t184 = t3 * 5.777125871528156e-5
        t185 = -t135
        t186 = t2 * 1.990958685365543e-5
        t187 = -t136
        t188 = t5 * 6.665308912837834e-5
        t189 = t5 * 1.025854963054676e-4
        t190 = -t142
        t192 = -t147
        t194 = t4 * 7.945477469564406e-5
        t196 = t4 * 8.527786971758762e-5
        t197 = t2 * 5.075119214062493e-5
        t198 = t2 * 7.026373028851282e-5
        t199 = t4 * 2.530750798561592e-5
        t203 = -t160
        t205 = t5 * 6.231460432689532e-5
        t206 = -t163
        t207 = t4 * 1.035949598927295e-4
        t208 = -t164
        t209 = -t167
        t210 = t2 * 1.449805829221316e-5
        t211 = t3 * 1.041928880331543e-5
        t214 = t2 * 1.25413155143806e-5
        t220 = t6 * 8.681155181287181e-5
        t221 = -t191
        t225 = -t204
        t226 = t6 * 3.10238027888272e-4
        t231 = t2 * 1.056183361921564e-7
        t83 = -t54
        t193 = -t148
        t200 = -t157
        t201 = -t158
        t202 = -t159
        t213 = -t177
        t215 = -t179
        t216 = -t181
        t217 = -t184
        t218 = -t188
        t219 = -t189
        t222 = -t197
        t223 = -t198
        t224 = -t199
        t227 = -t205
        t228 = -t210
        t229 = -t220
        t230 = -t226
        t232 = t9+t16+t51+t61+t110+t119+t128+t150+t165
        t233 = t7+t50+t74+t75+t131+t149+t152+t174+t187
        t234 = t34+t38+t56+t88+t93+t97+t126+t161+t173
        t235 = t12+t24+t62+t86+t116+t129+t145+t156+t208
        t236 = t11+t33+t55+t63+t124+t137+t144+t166+t225
        t237 = t15+t32+t77+t85+t100+t146+t175+t180+t206
        t238 = t45+t49+t82+t101+t121+t143+t153+t203+t209
        t240 = t27+t44+t66+t84+t96+t117+t132+t141+t176+t183+t192-6.597179531399043e-3
        t239 = t10+t39+t46+t76+t79+t83+t138+t169+t186+t194+t227+1.296445854400522e-2
        t241 = t20+t23+t52+t80+t91+t120+t140+t196+t200+t201+t223-2.308096979189481e-2
        t242 = t53+t68+t72+t73+t111+t113+t155+t182+t193+t207+t216+2.932900384013143e-3
        t243 = t60+t81+t95+t103+t105+t170+t172+t178+t202+t211+t214+6.089036815617693e-3
        t244 = t30+t37+t48+t92+t139+t168+t212+t218+t221+t230+t231+3.774400023003895e-2
        t245 = t31+t69+t89+t102+t154+t171+t195+t215+t217+t228+t229-7.366577404102816e-2
        t246 = t57+t70+t134+t151+t162+t185+t190+t213+t219+t222+t224-2.096823567033263e-2
        et1 = a1 * 6.821917091750646e-4-x3 * 3.951727826559497e-3-x4 * 1.916657593594715e-3+a1 * a2 * 5.594780559918539e-6-a1 * a3 * 4.567181873116333e-5
        et2 = a2 * x3 * (-3.368274268706217e-5)-a2 * x4 * 5.105190396538956e-4-a3 * x3 * 1.145664177521338e-3-a3 * x4 * 1.594379957236185e-5
        et3 = a1 * 5.934885765487179e-3-x3 * 3.65713335401095e-2+x4 * 2.466044260228168e-2+a1 * a2 * 1.027498191176246e-4-a1 * a3 * 1.514472104648178e-5
        et4 = a2 * x3 * (-9.473464059751308e-5)+a2 * x4 * 4.181150685304091e-4-a3 * x3 * 8.451150477966313e-4+a3 * x4 * 1.733621630505761e-4
        et5 = a1 * 5.502536263658815e-4-x3 * 2.207146940064599e-3-x4 * 1.866017144787887e-4+a1 * a2 * 2.661033907800858e-5+a1 * a3 * 1.629437096076357e-5
        et6 = a2 * x3 * 3.820894815388533e-6-a2 * x4 * 9.844366018439171e-5-a3 * x3 * 5.60393589040494e-5+a3 * x4 * 1.227825618147988e-4
        et7 = a1 * 1.488286258159424e-2-x3 * 1.284986335471678e-1-x4 * 7.39823909202904e-3-a1 * a2 * 6.313088581282673e-8-a1 * a3 * 2.230155029845751e-4
        et8 = a2 * x3 * (-1.103439300313224e-5)-a2 * x4 * 2.11724331845836e-4-a3 * x3 * 7.324403363652528e-4+a3 * x4 * 7.124316341513704e-4
        et9 = a1 * 4.482139243840852e-3-x3 * 1.697566110695159e-4+x4 * 4.238254466978134e-2-a1 * a2 * 1.817112801164086e-6
        et10 = a1 * a3 * (-5.368015756676231e-6)-a2 * x3 * 1.222129494087501e-5-a2 * x4 * 9.545761577474062e-5+a3 * x3 * 1.891223153640809e-4
        et11 = a3 * x4 * 1.48750272738868e-4
        et12 = a1 * 2.014998971299934e-3+x3 * 1.594779577977693e-2-x4 * 6.026389685417826e-4-a1 * a2 * 8.087616013044137e-7+a1 * a3 * 2.373948243334252e-5
        et13 = a2 * x3 * 2.547316053062041e-6-a2 * x4 * 1.017159559493265e-4+a3 * x3 * 7.648046873458211e-5-a3 * x4 * 2.65907909315005e-6
        dW_dvx = np.reshape([et1+et2,t242,t237,t235,t243,t236,t242,et3+et4,t240,t241,t234,t239,t237,t240,et5+et6,t238,t246,t232,t235,t241,t238,et7+et8,t245,t233,t243,t234,t246,t245,et9+et10+et11,t244,t236,t239,t232,t233,t244,et12+et13],(6,6))

        return dW_dvx
    
    def dW_dxi_fcn(self, i, x, a):
        if i == 2:
            return self.dW_dphi_fcn(x, a)
        elif i == 3:
            return self.dW_dvx_fcn(x, a)
        else:
            return np.zeros((6, 6))
        #TODO: raise error when i > system dimension

    def dW_da0_fcn(self, x, a):
        #dW_da1
        #    dW_da1 = dW_da1(IN1,IN2)
        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    24-Feb-2026 12:06:00

        a1 = a[0]
        a2 = a[1]
        a3 = a[2]
        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a2 ** 2
        t4 = a3 ** 2
        t5 = x3 ** 2
        t6 = x4 ** 2
        t7 = a1 * 3.207454469174795e-4
        t9 = x3 * x4 * 1.323512034861161e-4
        t10 = x3 * 2.225749550601661e-3
        t11 = a1 * x3 * 1.210147798249253e-3
        t13 = a3 * 2.941639407182785e-4
        t14 = a2 * 5.898744603758641e-3
        t15 = x3 * 1.394104899430828e-2
        t16 = a3 * 9.873409799035619e-4
        t18 = x4 * 3.152182909947604e-3
        t19 = x3 * x4 * 3.849704140366649e-5
        t20 = a2 * 5.449135545293495e-4
        t21 = a2 * 8.179801304642193e-4
        t22 = x3 * 1.119383473632318e-3
        t23 = a2 * 3.639599536503598e-3
        t24 = a1 * 3.125603459795274e-3
        t25 = x4 * 2.301371769593907e-3
        t26 = x4 * 1.769891259920849e-3
        t27 = x4 * 1.14039065757872e-3
        t28 = a1 * 2.780746107103629e-3
        t29 = a1 * 1.255469118800918e-3
        t30 = a2 * 2.09476005732234e-3
        t31 = a3 * 4.273725406000518e-4
        t32 = a1 * 1.858342092660756e-3
        t33 = a1 * a2 * 8.947875467367342e-5
        t34 = a3 * 1.52127636265978e-3
        t36 = x4 * 6.813935839314308e-3
        t38 = a1 * x3 * 2.588652538634923e-4
        t39 = a1 * 2.24180543106648e-3
        t40 = a2 * 1.502596331256631e-3
        t41 = x3 * 6.777571586165662e-4
        t42 = a3 * 1.130377086423186e-3
        t43 = a3 * 6.69233679049425e-4
        t44 = x4 * 2.883911422705963e-3
        t47 = x3 * 7.221551285611115e-4
        t48 = a1 * x4 * 2.679451751883594e-4
        t49 = x4 * 2.609792569790674e-4
        t51 = a1 * a2 * 9.580878671630898e-6
        t53 = x3 * 4.288863725149308e-4
        t58 = a2 * 7.443063482239241e-4
        t59 = a2 * a3 * 2.373353608880688e-5
        t61 = x3 * x4 * 2.822974835575876e-4
        t69 = a3 * 1.359584473115279e-4
        t71 = a1 * 3.802660989607871e-4
        t72 = a1 * a3 * 2.344746613738226e-4
        t75 = a2 * 8.677007199841303e-5
        t78 = a1 * a3 * 1.267914725168357e-4
        t79 = a2 * x3 * 7.794329961581855e-7
        t81 = a3 * x4 * 1.235878214702392e-4
        t82 = a1 * x3 * 2.515017246699702e-5
        t83 = x3 * 5.959733277905678e-5
        t84 = a1 * x3 * 7.019841299606078e-4
        t86 = a3 * x4 * 4.744256543512006e-5
        t87 = a3 * x4 * 1.344145897822859e-4
        t88 = a3 * 1.135548277459994e-4
        t90 = a3 * x3 * 5.425893286769079e-5
        t91 = a1 * a3 * 6.913460975114163e-5
        t92 = a1 * x4 * 1.405274605770256e-4
        t93 = a1 * x4 * 2.577485774358245e-4
        t94 = a2 * a3 * 5.255557335305046e-5
        t95 = a3 * x3 * 3.601502526880107e-5
        t96 = a1 * a3 * 3.024506395491655e-5
        t97 = a1 * x3 * 2.93093585723862e-5
        t98 = a3 * x3 * 4.507551511296527e-5
        t99 = a2 * a3 * 6.429982098811691e-6
        t100 = a3 * x4 * 1.805148966364645e-5
        t101 = a1 * x3 * 1.649980346260968e-5
        t102 = a2 * x3 * 1.298560457759987e-5
        t103 = a1 * x4 * 2.899611658442631e-5
        t105 = a1 * a3 * 2.339529085198145e-5
        t106 = a2 * x3 * 3.921422526469855e-6
        t107 = a3 * x4 * 3.722423874590391e-5
        t108 = a1 * a2 * 3.32598119732685e-5
        t109 = a2 * x4 * 4.407929860492906e-5
        t110 = a2 * x4 * 1.416843105650696e-5
        t112 = a2 * x4 * 2.431652943453245e-5
        t113 = a3 * x3 * 6.570988261230319e-5
        t115 = a1 * x3 * 8.555473718719821e-5
        t116 = a1 * a3 * 4.466306697438351e-5
        t119 = x3 * x4 * 7.764730068913363e-6
        t120 = a1 * x4 * 2.50826310287612e-5
        t121 = a1 * a2 * 1.692085603234359e-5
        t123 = a3 * x3 * 6.1609684282229e-5
        t125 = a1 * a3 * 3.823010591662866e-5
        t127 = a2 * x4 * 3.177983840193874e-6
        t128 = a1 * x4 * 3.981917370731086e-5
        t129 = a1 * a2 * 2.391295916199519e-5
        t132 = x3 * x4 * 9.139897312498338e-5
        t136 = x3 * x4 * 6.273083003586155e-5
        t137 = a3 * x3 * 6.076713135471063e-6
        t139 = a3 * x3 * 5.570719420196753e-5
        t140 = a2 * x4 * 1.055373937665878e-4
        t141 = a1 * x3 * 5.987815223824578e-5
        t143 = a3 * x4 * 3.081876444321027e-5
        t144 = a1 * x4 * 1.015023842812499e-4
        t147 = a2 * a3 * 7.59959136881775e-6
        t153 = a2 * x4 * 9.263763046520372e-6
        t154 = a2 * a3 * 3.142889926405839e-6
        t159 = a2 * x3 * 4.786525353192545e-6
        t160 = a2 * x3 * 2.482298690367733e-6
        t163 = a1 * a2 * 1.280919263796567e-6
        t164 = a2 * x3 * 3.034245574085445e-6
        t165 = a2 * a3 * 1.383602093082104e-5
        t172 = a2 * a3 * 6.144754848743782e-6
        t173 = a2 * a3 * 5.218852903776082e-6
        t176 = a3 * x4 * 5.233256484416083e-6
        t191 = x3 * x4 * 9.389692779518315e-6
        t195 = a1 * a2 * 5.038147989459259e-6
        t196 = a2 * x3 * 1.258781340826787e-6
        t197 = a2 * x4 * 2.461131862023077e-6
        t211 = x3 * x4 * 2.047893478278068e-7
        t216 = a1 * x4 * 2.112366723843128e-7
        t8 = -t7
        t12 = -t9
        t17 = -t11
        t35 = -t13
        t37 = -t15
        t45 = -t16
        t46 = -t18
        t50 = -t20
        t52 = -t23
        t54 = -t25
        t55 = -t26
        t56 = -t27
        t57 = -t28
        t60 = -t29
        t62 = -t30
        t63 = -t32
        t64 = -t36
        t65 = -t38
        t66 = t6 * 8.555063950712585e-5
        t67 = -t40
        t68 = -t41
        t70 = -t43
        t73 = t5 * 2.553779465735561e-5
        t74 = -t49
        t76 = -t51
        t77 = -t53
        t80 = -t58
        t85 = t4 * 1.508783843568142e-5
        t111 = t6 * 2.753884434588586e-4
        t114 = t5 * 3.949114930077374e-5
        t117 = -t79
        t118 = t6 * 7.219525017016203e-5
        t122 = t5 * 2.148172724790797e-4
        t124 = -t82
        t126 = -t83
        t130 = t6 * 4.107312270038745e-5
        t133 = -t86
        t134 = -t87
        t135 = t6 * 3.976000214756251e-4
        t138 = -t88
        t142 = t5 * 7.282845708970578e-5
        t145 = -t90
        t146 = -t92
        t148 = t4 * 3.321101865378538e-5
        t149 = t5 * 9.088554801142065e-5
        t150 = t2 * 4.53060179521612e-5
        t151 = t5 * 9.479348542422888e-6
        t152 = -t96
        t155 = -t101
        t156 = -t102
        t157 = -t103
        t158 = t4 * 9.497252900450433e-6
        t161 = -t107
        t162 = t4 * 2.636603605158817e-5
        t166 = -t110
        t169 = -t115
        t170 = -t116
        t171 = t5 * 3.391522429231649e-5
        t174 = -t119
        t175 = -t121
        t177 = -t123
        t178 = -t125
        t179 = t6 * 4.188628622117134e-6
        t180 = t3 * 2.72774172798064e-5
        t181 = t2 * 5.130123240868234e-5
        t182 = -t127
        t183 = -t132
        t184 = t4 * 9.569037004076137e-6
        t186 = -t136
        t187 = -t137
        t188 = t4 * 1.687248953710925e-5
        t189 = -t139
        t190 = t3 * 1.364735234764864e-5
        t192 = -t141
        t193 = t5 * 5.509953722606949e-5
        t194 = -t144
        t198 = -t147
        t200 = t4 * 2.803004000734594e-6
        t202 = t4 * 8.470473265460506e-6
        t203 = -t153
        t204 = t3 * 1.193766372595169e-5
        t205 = -t154
        t206 = t6 * 1.167316753683165e-5
        t207 = t3 * 4.775749824140782e-6
        t208 = -t160
        t209 = -t164
        t210 = -t165
        t213 = t3 * 2.358104063721858e-6
        t215 = t3 * 9.321080139297816e-6
        t217 = t3 * 2.332896724163466e-6
        t218 = t3 * 1.05565313587469e-5
        t220 = -t195
        t221 = t6 * 1.195700109711878e-5
        t222 = -t197
        t223 = t2 * 6.106492744303252e-6
        t224 = t2 * 1.820116789726556e-5
        t227 = t2 * 2.360159118498814e-5
        t230 = t2 * 3.550972240588954e-5
        t231 = t2 * 2.997000582585e-5
        t234 = t2 * 2.71384395925122e-5
        t89 = -t66
        t104 = -t73
        t131 = -t85
        t167 = -t111
        t168 = -t114
        t185 = -t135
        t199 = -t150
        t201 = -t151
        t212 = -t171
        t214 = -t181
        t219 = -t190
        t225 = -t200
        t226 = -t202
        t228 = -t204
        t229 = -t206
        t232 = -t217
        t233 = -t218
        t235 = -t223
        t236 = -t231
        t237 = t37+t39+t55+t78+t108+t112+t113+t117+t134
        t238 = t33+t47+t54+t60+t91+t100+t140+t145+t159
        t239 = t10+t46+t63+t81+t109+t129+t156+t177+t178
        t240 = t44+t71+t72+t76+t77+t143+t189+t203+t209
        t241 = t24+t56+t68+t95+t133+t152+t163+t196+t222
        t242 = t8+t22+t74+t166+t170+t176+t187+t208+t220
        t243 = t57+t64+t98+t105+t106+t126+t161+t175+t182
        t244 = t21+t42+t59+t61+t65+t93+t148+t149+t180+t185+t236+2.213995818437848e-2
        t245 = t12+t14+t45+t89+t104+t128+t184+t192+t198+t215+t230-2.101997829086588e-3
        t246 = t19+t52+t70+t84+t94+t122+t146+t167+t199+t226+t228-1.086042277100285e-2
        t247 = t17+t35+t75+t99+t120+t130+t174+t188+t193+t219+t224-2.683177086024303e-2
        t248 = t31+t80+t124+t131+t142+t183+t194+t205+t214+t221+t233-6.104962370553785e-4
        t249 = t48+t50+t97+t118+t138+t158+t168+t186+t210+t213+t227-1.01311423520185e-4
        t250 = t34+t62+t155+t157+t162+t172+t191+t207+t212+t229+t234+1.192323880171517e-2
        t251 = t67+t69+t169+t173+t179+t201+t211+t216+t225+t232+t235+2.53522454458866e-3
        et1 = a1 * (-4.823481925197377e-3)-x3 * 7.064867672233546e-3+x4 * 6.821917091750646e-4+a1 * a2 * 9.423349488786966e-5+a1 * a3 * 5.526994572294836e-5
        et2 = a2 * x3 * (-3.816218354486824e-5)+a2 * x4 * 5.594780559918539e-6+a3 * x3 * 4.871998858139492e-5-a3 * x4 * 4.567181873116333e-5
        et3 = a1 * 2.585219068639188e-3-x3 * 9.829336747093582e-3+x4 * 5.934885765487179e-3+a1 * a2 * 3.987229866787482e-5-a1 * a3 * 4.098071635200598e-5
        et4 = a2 * x3 * 1.647165207278163e-5+a2 * x4 * 1.027498191176246e-4-a3 * x3 * 3.918670979670312e-5-a3 * x4 * 1.514472104648178e-5
        et5 = a1 * 1.28443845376932e-4-x3 * 4.380195160061657e-4+x4 * 5.502536263658815e-4+a1 * a2 * 2.720173545785811e-5+a1 * a3 * 5.510348125120493e-5
        et6 = a2 * x3 * 5.554451339473293e-6+a2 * x4 * 2.661033907800858e-5-a3 * x3 * 1.733335512688493e-5+a3 * x4 * 1.629437096076357e-5
        et7 = a1 * 1.156819208587122e-3+x3 * 1.366206816299177e-2+x4 * 1.488286258159424e-2-a1 * a2 * 1.410589692472028e-5-a1 * a3 * 7.281469694509823e-5
        et8 = a2 * x3 * (-1.915448614273191e-7)-a2 * x4 * 6.313088581282673e-8+a3 * x3 * 1.122171226128688e-4-a3 * x4 * 2.230155029845751e-4
        et9 = a1 * 1.124640168729006e-3+x3 * 1.321690972221742e-2+x4 * 4.482139243840852e-3-a1 * a2 * 2.55397018683427e-5+a1 * a3 * 4.524219203775198e-6
        et10 = a2 * x3 * 1.807575275406591e-5-a2 * x4 * 1.817112801164086e-6-a3 * x3 * 4.45186817910887e-6-a3 * x4 * 5.368015756676231e-6
        et11 = a1 * 3.069786254594602e-3-x3 * 6.713283474447665e-4+x4 * 2.014998971299934e-3-a1 * a2 * 1.158805288989942e-5+a1 * a3 * 4.204798002827091e-5
        et12 = a2 * x3 * (-2.143156436752165e-5)-a2 * x4 * 8.087616013044137e-7-a3 * x3 * 5.644067535146321e-6+a3 * x4 * 2.373948243334252e-5
        dW_da1 = np.reshape([et1+et2,t244,t242,t237,t247,t241,t244,et3+et4,t249,t246,t239,t245,t242,t249,et5+et6,t240,t248,t238,t237,t246,t240,et7+et8,t250,t243,t247,t239,t248,t250,et9+et10,t251,t241,t245,t238,t243,t251,et11+et12],(6,6))

        return dW_da1

    def dW_da1_fcn(self, x, a):
        #dW_da2
        #    dW_da2 = dW_da2(IN1,IN2)

        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    24-Feb-2026 12:06:01

        a1 = a[0]
        a2 = a[1]
        a3 = a[2]
        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a2 ** 2
        t4 = a3 ** 2
        t5 = x3 ** 2
        t6 = x4 ** 2
        t7 = a2 * 1.965971896831232e-2
        t8 = a2 * 2.56119311919389e-2
        t9 = x3 * 1.455580502263925e-2
        t10 = a2 * x4 * 3.186063500276205e-5
        t11 = a2 * 1.263975446327333e-2
        t12 = x4 * 1.820885998119711e-2
        t13 = a1 * 5.898744603758641e-3
        t14 = x3 * 2.868300766725062e-2
        t15 = x4 * 9.340139044743925e-3
        t16 = x3 * x4 * 7.721288568664415e-5
        t17 = a3 * 1.564869046054163e-3
        t18 = x4 * 6.439478192723586e-3
        t20 = a2 * 7.114018606395075e-3
        t21 = a1 * 5.449135545293495e-4
        t22 = a1 * 8.179801304642193e-4
        t23 = x3 * 1.350257091937334e-2
        t24 = a2 * 3.606709631706964e-3
        t25 = a2 * 6.499778617984951e-3
        t26 = a1 * 3.639599536503598e-3
        t27 = x4 * 3.779524930977533e-3
        t29 = a3 * 2.518011666024459e-3
        t31 = x3 * 2.928550469903756e-3
        t32 = x4 * 3.080230695512382e-3
        t33 = x3 * 2.488053643575947e-3
        t34 = x4 * 5.160062162195848e-3
        t36 = a1 * 2.09476005732234e-3
        t37 = x3 * 7.680392689150805e-3
        t38 = a2 * 1.084542268201378e-2
        t40 = a3 * 3.76378195902419e-3
        t41 = a3 * 4.218876777868563e-3
        t42 = a3 * x4 * 4.263557567343933e-5
        t43 = a3 * 1.130659943387743e-2
        t44 = a3 * 2.612782880003055e-3
        t45 = a1 * 1.502596331256631e-3
        t46 = x3 * 1.347307901080429e-2
        t47 = a3 * 7.294688913410115e-3
        t49 = x3 * 6.644621968634411e-3
        t50 = a2 * x4 * 4.484687713993351e-4
        t52 = x4 * 6.793156588558632e-4
        t53 = x4 * 4.63686103144533e-4
        t59 = a1 * 7.443063482239241e-4
        t60 = a2 * x3 * 1.256546263583763e-3
        t61 = a1 * a3 * 2.373353608880688e-5
        t64 = a2 * x4 * 1.294673112119447e-4
        t65 = a2 * x3 * 1.656201182828816e-3
        t74 = a2 * x3 * 2.935024955593972e-4
        t75 = a2 * x3 * 9.56156281265256e-5
        t76 = a1 * 8.677007199841303e-5
        t77 = a3 * x4 * 2.03809951337215e-4
        t78 = a1 * x3 * 7.794329961581855e-7
        t80 = a2 * x4 * 1.904369925278465e-4
        t81 = a2 * a3 * 3.769561660765942e-4
        t82 = a1 * a2 * 5.45548345596128e-5
        t83 = a2 * a3 * 9.239458764225637e-5
        t84 = x3 * x4 * 6.221739244062027e-5
        t86 = a3 * x4 * 9.618251165587616e-5
        t88 = a1 * a2 * 2.729470469529729e-5
        t89 = a3 * x4 * 1.067457847629088e-4
        t91 = a1 * a3 * 5.255557335305046e-5
        t93 = x3 * x4 * 2.992739605832603e-5
        t94 = x3 * x4 * 8.060426722306369e-5
        t95 = x3 * x4 * 4.436447043168475e-5
        t96 = a1 * a3 * 6.429982098811691e-6
        t97 = a1 * a2 * 2.387532745190339e-5
        t98 = a2 * a3 * 1.058742145453045e-5
        t99 = a3 * x4 * 5.342962529383422e-5
        t100 = a1 * x3 * 1.298560457759987e-5
        t102 = a1 * a2 * 9.551499648281564e-6
        t105 = a2 * x4 * 1.079948855727536e-4
        t106 = a3 * x3 * 1.853937395538713e-5
        t108 = a3 * x3 * 5.532028004895475e-6
        t110 = a1 * x3 * 3.921422526469855e-6
        t111 = a2 * x4 * 2.083857760663086e-5
        t112 = a1 * x4 * 4.407929860492906e-5
        t113 = a1 * x4 * 1.416843105650696e-5
        t114 = a1 * x4 * 2.431652943453245e-5
        t115 = a3 * x4 * 4.764903580573234e-5
        t117 = a3 * x3 * 1.321681312877855e-5
        t118 = a2 * x4 * 5.201422791852437e-5
        t119 = a2 * x3 * 9.767514840081398e-5
        t120 = a2 * x3 * 5.399861648134265e-5
        t121 = a2 * x4 * 1.155425174305631e-4
        t122 = a3 * x4 * 2.166713786198809e-5
        t123 = a1 * x4 * 3.177983840193874e-6
        t124 = a1 * a2 * 1.864216027859563e-5
        t125 = a2 * x3 * 7.471485544131849e-5
        t126 = a1 * a2 * 2.111306271749381e-5
        t128 = a2 * a3 * 2.70893119172076e-5
        t129 = a2 * x3 * 4.197824789459975e-5
        t130 = a1 * x4 * 1.055373937665878e-4
        t133 = a2 * a3 * 4.157897680294928e-5
        t134 = a3 * x3 * 5.642539315491211e-5
        t135 = x3 * x4 * 4.979015940501063e-6
        t136 = a1 * a3 * 7.59959136881775e-6
        t140 = x3 * x4 * 8.014276646591743e-6
        t142 = a1 * x4 * 9.263763046520372e-6
        t143 = a1 * a3 * 3.142889926405839e-6
        t151 = a1 * x3 * 4.786525353192545e-6
        t152 = a3 * x3 * 4.961901342749391e-6
        t153 = a1 * x3 * 2.482298690367733e-6
        t157 = a1 * x3 * 3.034245574085445e-6
        t158 = a1 * a3 * 1.383602093082104e-5
        t163 = a1 * a3 * 6.144754848743782e-6
        t167 = a1 * a3 * 5.218852903776082e-6
        t169 = a1 * a2 * 4.716208127443715e-6
        t175 = a2 * a3 * 6.668511478857129e-6
        t176 = a3 * x3 * 1.065752729756403e-5
        t178 = a1 * a2 * 4.665793448326931e-6
        t180 = a3 * x4 * 2.832561323293555e-6
        t185 = a3 * x3 * 5.165504890926678e-6
        t187 = a1 * x3 * 1.258781340826787e-6
        t190 = a1 * x4 * 2.461131862023077e-6
        t203 = a3 * x3 * 2.271458802739849e-7
        t206 = a2 * a3 * 8.717645305780905e-7
        t19 = -t7
        t28 = -t8
        t30 = -t9
        t35 = -t11
        t39 = -t12
        t48 = -t15
        t51 = -t18
        t54 = -t21
        t55 = -t24
        t56 = -t26
        t57 = -t27
        t58 = -t29
        t62 = -t36
        t63 = t2 * 4.473937733683671e-5
        t66 = -t38
        t67 = -t42
        t68 = -t43
        t69 = -t44
        t70 = -t45
        t71 = -t46
        t72 = -t47
        t73 = -t49
        t79 = -t59
        t85 = -t65
        t87 = t6 * 1.246639638843462e-5
        t90 = t5 * 2.263085159544357e-5
        t92 = -t74
        t101 = t6 * 2.722279033094108e-4
        t103 = -t75
        t104 = t6 * 7.535296054922639e-5
        t107 = t2 * 4.790439335815449e-6
        t109 = t6 * 2.609172562835969e-4
        t116 = -t78
        t127 = t6 * 3.526622405542186e-5
        t131 = t4 * 6.300693621298501e-5
        t132 = -t88
        t137 = -t93
        t138 = -t94
        t139 = t6 * 2.768859529464367e-5
        t141 = -t95
        t144 = -t97
        t145 = -t98
        t146 = -t100
        t148 = t6 * 1.198568483162489e-5
        t155 = t5 * 3.603625206070048e-5
        t156 = t2 * 1.662990598663425e-5
        t159 = -t113
        t160 = -t115
        t161 = t5 * 2.09152527404764e-5
        t162 = -t117
        t164 = -t118
        t165 = t4 * 4.246769011282069e-5
        t166 = -t119
        t168 = t4 * 2.039000946666308e-5
        t170 = -t121
        t171 = t4 * 2.500123030444657e-5
        t172 = t5 * 1.399336004376047e-5
        t173 = -t122
        t174 = -t123
        t177 = t2 * 1.195647958099759e-5
        t179 = t4 * 3.413870996306959e-5
        t181 = -t126
        t183 = t5 * 5.807420441272242e-7
        t184 = -t128
        t186 = -t133
        t188 = t5 * 2.032394324219051e-5
        t189 = -t135
        t191 = -t136
        t192 = -t142
        t193 = -t143
        t194 = t3 * 7.32586713482265e-6
        t196 = t4 * 4.825008125221568e-6
        t197 = -t153
        t198 = t2 * 6.404596318982834e-7
        t199 = -t157
        t200 = -t158
        t201 = t2 * 8.460428016171793e-6
        t202 = t4 * 4.406570072110079e-6
        t207 = -t175
        t208 = -t176
        t209 = -t178
        t211 = t3 * 3.091796670989417e-6
        t212 = -t180
        t214 = t3 * 7.534057192642986e-5
        t215 = -t185
        t216 = t2 * 2.51907399472963e-6
        t217 = t5 * 7.543572678488927e-6
        t219 = -t190
        t220 = t3 * 2.203062439958097e-5
        t222 = t3 * 1.608327165197091e-5
        t226 = -t203
        t227 = -t206
        t228 = t3 * 3.949779446122302e-5
        t229 = t3 * 5.578543577215559e-6
        t147 = -t101
        t149 = -t104
        t150 = -t107
        t154 = -t109
        t182 = -t127
        t195 = -t148
        t204 = -t171
        t205 = -t172
        t210 = -t179
        t213 = -t183
        t218 = -t188
        t221 = -t194
        t223 = -t196
        t224 = -t201
        t225 = -t202
        t230 = -t216
        t231 = -t217
        t232 = -t229
        t233 = t22+t52+t61+t71+t80+t82+t89+t92+t152
        t234 = t13+t14+t39+t67+t105+t108+t124+t166+t191
        t235 = t33+t57+t76+t85+t86+t96+t106+t111+t132
        t236 = t30+t34+t62+t77+t102+t125+t134+t163+t170
        t237 = t51+t56+t60+t64+t73+t91+t99+t144+t208
        t238 = t10+t23+t48+t70+t103+t162+t167+t209+t212
        t239 = t31+t32+t50+t54+t120+t160+t169+t200+t226
        t240 = t37+t53+t79+t129+t164+t173+t181+t193+t215
        t241 = t25+t68+t83+t114+t116+t131+t138+t147+t155+t156+t228+1.113903227614737e-2
        t242 = t16+t19+t41+t110+t145+t168+t174+t182+t218+t220+t224+1.977709710873444e-2
        t243 = t55+t58+t63+t130+t140+t151+t154+t165+t186+t205+t214-4.726657861103465e-3
        t244 = t17+t35+t87+t90+t137+t159+t184+t197+t225+t230+t232+4.390196795005612e-2
        t245 = t28+t72+t84+t112+t146+t161+t177+t195+t207+t210+t222-3.064894365687242e-2
        t246 = t20+t69+t81+t139+t150+t189+t192+t199+t204+t221+t231-6.469368423444415e-2
        t247 = t40+t66+t141+t149+t187+t198+t211+t213+t219+t223+t227+5.359348464841988e-3
        et1 = a2 * (-3.912989564642964e-2)+a3 * 1.603983971325309e-3+t2 * 4.711674744393483e-5+t3 * 2.348134754612068e-5+t4 * 3.522387689289633e-5
        et2 = t5 * 1.402949812002114e-5-t6 * 2.552595198269478e-4+a2 * a3 * 3.337236162146113e-5-a1 * x3 * 3.816218354486824e-5
        et3 = a1 * x4 * 5.594780559918539e-6-x3 * x4 * 3.368274268706217e-5-7.365419162084984e-2
        et4 = a2 * (-1.220887908868363e-1)-a3 * 5.05747042862627e-3+t2 * 1.993614933393741e-5+t3 * 1.700486851582814e-5-t4 * 6.688175317682259e-5
        et5 = t5 * (-1.620005140457497e-4)+t6 * 2.090575342652045e-4-a2 * a3 * 1.300224373875273e-5+a1 * x3 * 1.647165207278163e-5
        et6 = a1 * x4 * 1.027498191176246e-4-x3 * x4 * 9.473464059751308e-5-5.960672745060339e-2
        et7 = a2 * 1.265151931977252e-2-a3 * 1.210101164179096e-3+t2 * 1.360086772892905e-5+t3 * 8.521077343295816e-6
        et8 = t4 * 5.250636393866849e-6+t5 * 1.240432349679295e-5-t6 * 4.922183009219586e-5+a2 * a3 * 1.124061361986932e-5
        et9 = a1 * x3 * 5.554451339473293e-6+a1 * x4 * 2.661033907800858e-5+x3 * x4 * 3.820894815388533e-6-1.322047776222541e-2
        et10 = a2 * 1.693136068742795e-2-a3 * 8.649441943956331e-3-t2 * 7.052948462360142e-6+t3 * 1.280016905530676e-5+t4 * 2.238737270908241e-5
        et11 = t5 * 1.488261337250342e-5-t6 * 1.05862165922918e-4+a2 * a3 * 4.011883183798974e-5-a1 * x3 * 1.915448614273191e-7
        et12 = a1 * x4 * (-6.313088581282673e-8)-x3 * x4 * 1.103439300313224e-5+3.355109414117514e-2
        et13 = a2 * 1.514726136443831e-2+a3 * 4.699387570157914e-3-t2 * 1.276985093417135e-5+t3 * 4.673873837107059e-5+t4 * 1.313071208616612e-5
        et14 = t5 * 4.355406375448561e-5-t6 * 4.772880788737031e-5-a2 * a3 * 4.176444527994128e-5+a1 * x3 * 1.807575275406591e-5
        et15 = a1 * x4 * (-1.817112801164086e-6)-x3 * x4 * 1.222129494087501e-5+9.272530936674332e-2
        et16 = a2 * 6.010166572811532e-2+a3 * 1.081982536400252e-3-t2 * 5.794026444949711e-6+t3 * 9.05466683637137e-6+t4 * 1.041017140350218e-5
        et17 = t5 * 2.61412860711464e-5-t6 * 5.085797797466325e-5-a2 * a3 * 1.894261281716029e-5-a1 * x3 * 2.143156436752165e-5
        et18 = a1 * x4 * (-8.087616013044137e-7)+x3 * x4 * 2.547316053062041e-6-3.586163413177857e-2
        dW_da2 = np.reshape([et1+et2+et3,t233,t244,t241,t235,t247,t233,et4+et5+et6,t239,t237,t245,t234,t244,t239,et7+et8+et9,t246,t240,t243,t241,t237,t246,et10+et11+et12,t236,t242,t235,t245,t240,t236,et13+et14+et15,t238,t247,t234,t243,t242,t238,et16+et17+et18],(6,6))

        return dW_da2

    def dW_da2_fcn(self, x, a):
        #dW_da3
        #    dW_da3 = dW_da3(IN1,IN2)
        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    24-Feb-2026 12:06:02

        a1 = a[0]
        a2 = a[1]
        a3 = a[2]
        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a2 ** 2
        t4 = a3 ** 2
        t5 = x3 ** 2
        t6 = x4 ** 2
        t7 = x3 * 1.261474834321218e-2
        t8 = a3 * 1.100201490980833e-2
        t9 = a1 * 2.941639407182785e-4
        t10 = x3 * 6.679833601939172e-3
        t11 = x4 * 8.185180182837971e-3
        t12 = a1 * 9.873409799035619e-4
        t13 = a2 * 1.564869046054163e-3
        t14 = a3 * 2.026357072127092e-4
        t16 = a3 * 2.672506821264396e-3
        t17 = a2 * 2.518011666024459e-3
        t18 = x3 * 1.395977747748336e-2
        t20 = a3 * 2.652700302724443e-3
        t21 = x3 * 4.744599670250461e-3
        t22 = a1 * 4.273725406000518e-4
        t23 = x4 * 3.599598664009162e-3
        t24 = x4 * 1.607646851388347e-3
        t25 = x3 * 8.343846478999065e-4
        t26 = x4 * 2.960189946830549e-3
        t27 = x4 * 5.172824677050956e-4
        t28 = a1 * 1.52127636265978e-3
        t30 = a2 * 3.76378195902419e-3
        t31 = a2 * 4.218876777868563e-3
        t32 = a2 * x4 * 4.263557567343933e-5
        t33 = x4 * 5.099177223396889e-4
        t34 = a2 * 1.130659943387743e-2
        t35 = x3 * 9.523034373174978e-3
        t36 = a2 * 2.612782880003055e-3
        t37 = a3 * 1.150913664600459e-3
        t38 = a2 * 7.294688913410115e-3
        t39 = a1 * 1.130377086423186e-3
        t40 = x3 * 2.460260298444739e-3
        t41 = x4 * 1.849085185151516e-3
        t42 = a1 * 6.69233679049425e-4
        t43 = a3 * 1.404144055121634e-3
        t44 = x4 * 3.861380307594414e-4
        t46 = x3 * x4 * 4.345281935137833e-6
        t48 = a3 * 6.693636558185797e-4
        t49 = x3 * 9.675298179337204e-4
        t53 = a3 * x4 * 2.774291485586877e-4
        t54 = a1 * a2 * 2.373353608880688e-5
        t58 = a1 * a3 * 3.017567687136285e-5
        t66 = a1 * 1.359584473115279e-4
        t69 = x3 * x4 * 4.193628421669213e-4
        t70 = a3 * x4 * 2.071899197854589e-4
        t71 = a3 * x3 * 2.054552232814257e-4
        t72 = a3 * x4 * 1.56556141681625e-4
        t74 = a3 * x3 * 2.52624303203666e-4
        t75 = a2 * x4 * 2.03809951337215e-4
        t76 = a3 * x3 * 3.860062401074155e-4
        t77 = a2 * a3 * 8.493538022564138e-5
        t78 = a1 * x4 * 1.235878214702392e-4
        t80 = a2 * a3 * 6.827741992613919e-5
        t81 = a2 * x4 * 9.618251165587616e-5
        t82 = x3 * x4 * 2.625101265547977e-4
        t83 = a1 * x4 * 4.744256543512006e-5
        t84 = a1 * x4 * 1.344145897822859e-4
        t85 = x3 * x4 * 1.003301915851869e-4
        t86 = x3 * x4 * 1.538791132481895e-4
        t87 = a1 * 1.135548277459994e-4
        t88 = a3 * x4 * 1.589095493912881e-4
        t89 = a2 * a3 * 1.2601387242597e-4
        t91 = a3 * x4 * 1.705557394351752e-4
        t92 = a2 * x4 * 1.067457847629088e-4
        t93 = a1 * x3 * 5.425893286769079e-5
        t94 = x3 * x4 * 6.173244154541164e-5
        t95 = a3 * x3 * 8.506172980452157e-4
        t97 = a1 * a2 * 5.255557335305046e-5
        t99 = a1 * a3 * 6.642203730757076e-5
        t100 = a1 * x3 * 3.601502526880107e-5
        t101 = a1 * a3 * 5.606008001469188e-6
        t102 = a1 * a3 * 1.694094653092101e-5
        t103 = a1 * x3 * 4.507551511296527e-5
        t104 = a1 * a2 * 6.429982098811691e-6
        t105 = a3 * x4 * 3.478530331398213e-5
        t106 = a1 * x4 * 1.805148966364645e-5
        t108 = a2 * x4 * 5.342962529383422e-5
        t109 = a3 * x3 * 3.030798675574956e-5
        t110 = a2 * x3 * 1.853937395538713e-5
        t111 = a3 * x3 * 5.414767802314347e-5
        t112 = a2 * x3 * 5.532028004895475e-6
        t113 = a1 * a3 * 1.899450580090087e-5
        t114 = a1 * x4 * 3.722423874590391e-5
        t115 = a1 * a3 * 5.273207210317634e-5
        t118 = a1 * x3 * 6.570988261230319e-5
        t119 = a2 * x4 * 4.764903580573234e-5
        t120 = x3 * x4 * 6.324618271523717e-5
        t121 = a2 * x3 * 1.321681312877855e-5
        t122 = a3 * x4 * 3.415830109484886e-5
        t123 = a2 * a3 * 8.813140144220158e-6
        t124 = a2 * a3 * 4.078001893332617e-5
        t126 = a1 * x3 * 6.1609684282229e-5
        t128 = a3 * x3 * 3.007901763981836e-5
        t129 = a2 * a3 * 5.000246060889314e-5
        t130 = a2 * x4 * 2.166713786198809e-5
        t134 = a1 * a3 * 1.913807400815227e-5
        t138 = a1 * x3 * 6.076713135471063e-6
        t139 = a1 * a3 * 3.374497907421851e-5
        t140 = a3 * x3 * 7.113462822601277e-5
        t142 = a1 * x3 * 5.570719420196753e-5
        t145 = a1 * x4 * 3.081876444321027e-5
        t147 = a3 * x4 * 5.061501597123185e-5
        t150 = a2 * x3 * 5.642539315491211e-5
        t151 = a1 * a2 * 7.59959136881775e-6
        t155 = a1 * a2 * 3.142889926405839e-6
        t160 = a2 * a3 * 9.650016250443136e-6
        t161 = a2 * x3 * 4.961901342749391e-6
        t163 = a1 * a2 * 1.383602093082104e-5
        t168 = a1 * a2 * 6.144754848743782e-6
        t169 = a1 * a2 * 5.218852903776082e-6
        t172 = a1 * x4 * 5.233256484416083e-6
        t181 = a2 * x3 * 1.065752729756403e-5
        t185 = a2 * x4 * 2.832561323293555e-6
        t188 = a2 * x3 * 5.165504890926678e-6
        t207 = a2 * x3 * 2.271458802739849e-7
        t15 = -t7
        t19 = -t8
        t29 = -t9
        t45 = -t12
        t47 = t5 * 9.754663935139995e-5
        t50 = -t16
        t51 = -t17
        t52 = -t18
        t55 = -t21
        t56 = -t23
        t57 = -t24
        t59 = -t25
        t60 = -t27
        t61 = -t32
        t62 = -t34
        t63 = -t35
        t64 = -t36
        t65 = -t38
        t67 = -t42
        t68 = t6 * 1.154353496792997e-4
        t73 = -t48
        t79 = -t58
        t90 = t4 * 3.106861742909019e-4
        t96 = -t69
        t98 = t6 * 1.449964260687359e-4
        t107 = -t71
        t116 = -t74
        t117 = t2 * 6.339573625841787e-5
        t125 = t3 * 1.884780830382971e-4
        t127 = t6 * 1.12231665814725e-4
        t131 = t6 * 1.614178714005059e-4
        t132 = -t80
        t133 = -t82
        t135 = -t83
        t136 = -t84
        t137 = -t85
        t141 = -t87
        t143 = t5 * 4.346493299095738e-4
        t144 = t4 * 2.626230702596799e-4
        t146 = -t93
        t148 = -t94
        t149 = -t95
        t152 = -t101
        t153 = -t102
        t154 = t2 * 1.172373306869113e-4
        t156 = t3 * 5.293710727265223e-6
        t157 = t5 * 5.381111985981855e-5
        t158 = t6 * 9.345717337133461e-5
        t159 = -t111
        t162 = -t114
        t164 = t4 * 3.403234619480612e-4
        t165 = t2 * 2.233153348719176e-5
        t166 = -t119
        t167 = -t121
        t170 = -t122
        t171 = -t123
        t173 = -t126
        t175 = t2 * 1.911505295831433e-5
        t176 = t5 * 9.060362049073322e-5
        t177 = t6 * 6.205049337642902e-5
        t178 = t3 * 4.619729382112819e-5
        t179 = -t129
        t180 = -t130
        t183 = t5 * 1.288313832775847e-5
        t184 = t4 * 2.721338008653159e-5
        t186 = -t138
        t187 = t3 * 1.35446559586038e-5
        t189 = -t140
        t190 = -t142
        t191 = t3 * 2.078948840147464e-5
        t192 = t2 * 3.456730487557082e-5
        t193 = -t147
        t194 = t6 * 8.000519180733984e-5
        t195 = t5 * 7.073224578008551e-5
        t196 = -t151
        t197 = t2 * 1.512253197745827e-5
        t198 = -t155
        t201 = t4 * 7.774609692608616e-5
        t202 = -t160
        t203 = t2 * 1.169764542599072e-5
        t204 = -t163
        t206 = t5 * 1.333787276096455e-5
        t209 = t3 * 3.334255739428564e-6
        t210 = -t181
        t211 = t4 * 6.635284836929457e-5
        t213 = -t185
        t215 = -t188
        t218 = t4 * 1.905940021233216e-5
        t221 = -t207
        t222 = t3 * 4.358822652890452e-7
        t174 = -t127
        t182 = -t131
        t199 = -t156
        t200 = -t157
        t205 = -t165
        t208 = -t175
        t212 = -t184
        t214 = -t187
        t216 = -t191
        t217 = -t197
        t219 = -t201
        t220 = -t206
        t223 = -t209
        t224 = -t211
        t225 = -t222
        t226 = t10+t39+t54+t60+t70+t92+t99+t116+t161
        t227 = t29+t40+t44+t72+t81+t104+t110+t139+t149
        t228 = t11+t15+t67+t76+t91+t97+t108+t153+t210
        t229 = t41+t45+t52+t61+t88+t112+t134+t159+t196
        t230 = t28+t56+t63+t75+t107+t115+t150+t168+t170
        t231 = t22+t57+t59+t79+t128+t180+t193+t198+t215
        t232 = t26+t55+t66+t105+t152+t167+t169+t189+t213
        t233 = t33+t49+t53+t109+t113+t141+t166+t204+t221
        t236 = t20+t64+t98+t125+t133+t143+t145+t154+t164+t179+t190-4.010878911067357e-4
        t234 = t43+t62+t89+t90+t117+t118+t136+t148+t178+t194+t200-2.342346450981792e-2
        t235 = t50+t51+t68+t77+t86+t106+t144+t146+t176+t192+t216+8.790398663186228e-4
        t237 = t19+t31+t103+t120+t124+t162+t182+t183+t199+t203+t219-9.048860167943793e-3
        t238 = t13+t47+t73+t137+t171+t172+t177+t186+t205+t212+t214-5.029644077785602e-3
        t239 = t14+t30+t46+t100+t135+t174+t195+t202+t217+t224+t225-1.010608032751627e-3
        t240 = t37+t65+t78+t96+t132+t158+t173+t208+t218+t220+t223-2.696249591844188e-3
        et1 = a2 * 1.603983971325309e-3-a3 * 7.286070658219603e-4+t2 * 2.763497286147418e-5+t3 * 1.668618081073057e-5+t4 * 2.121419834903038e-4
        et2 = t5 * (-9.09093895607392e-5)-t6 * 7.971899786180924e-6+a2 * a3 * 7.044775378579267e-5+a1 * x3 * 4.871998858139492e-5
        et3 = a1 * x4 * (-4.567181873116333e-5)-x3 * x4 * 1.145664177521338e-3+4.370659301512875e-2
        et4 = a2 * (-5.05747042862627e-3)+a3 * 2.021842969219186e-3-t2 * 2.049035817600299e-5-t3 * 6.501121869376363e-6
        et5 = t4 * 3.295377404515563e-5+t5 * 5.14424875195423e-5+t6 * 8.668108152528807e-5-a2 * a3 * 1.337635063536452e-4
        et6 = a1 * x3 * (-3.918670979670312e-5)-a1 * x4 * 1.514472104648178e-5-x3 * x4 * 8.451150477966313e-4+2.811584498011763e-2
        et7 = a2 * (-1.210101164179096e-3)+a3 * 8.826283443884876e-4+t2 * 2.755174062560246e-5+t3 * 5.620306809934659e-6+t4 * 4.80876307223913e-5
        et8 = t5 * (-2.458385442366396e-5)+t6 * 6.13912809073994e-5+a2 * a3 * 1.05012727877337e-5-a1 * x3 * 1.733335512688493e-5
        et9 = a1 * x4 * 1.629437096076357e-5-x3 * x4 * 5.60393589040494e-5+4.512473415888808e-4
        et10 = a2 * (-8.649441943956331e-3)+a3 * 8.947484295375088e-3-t2 * 3.640734847254911e-5+t3 * 2.005941591899487e-5+t4 * 2.100542079632992e-4
        et11 = t5 * 1.612032429556571e-4+t6 * 3.562158170756852e-4+a2 * a3 * 4.477474541816482e-5+a1 * x3 * 1.122171226128688e-4-a1 * x4 * 2.230155029845751e-4
        et12 = x3 * x4 * (-7.324403363652528e-4)-3.95563535147516e-2
        et13 = a2 * 4.699387570157914e-3-a3 * 1.427957598018044e-3+t2 * 2.262109601887599e-6-t3 * 2.088222263997064e-5
        et14 = t4 * (-5.752689566288796e-5)+t5 * 8.264202566719489e-6+t6 * 7.437513636943402e-5+a2 * a3 * 2.626142417233223e-5
        et15 = a1 * x3 * (-4.45186817910887e-6)-a1 * x4 * 5.368015756676231e-6+x3 * x4 * 1.891223153640809e-4-6.22328441926847e-2
        et16 = a2 * 1.081982536400252e-3+a3 * 1.013114559855105e-2+t2 * 2.102399001413546e-5-t3 * 9.471306408580144e-6+t4 * 3.613846999804849e-5
        et17 = t5 * 3.114915284538848e-6-t6 * 1.329539546575025e-6+a2 * a3 * 2.082034280700435e-5-a1 * x3 * 5.644067535146321e-6
        et18 = a1 * x4 * 2.373948243334252e-5+x3 * x4 * 7.648046873458211e-5+8.290964675886718e-3
        dW_da3 = np.reshape([et1+et2+et3,t226,t238,t234,t227,t239,t226,et4+et5+et6,t233,t228,t240,t229,t238,t233,et7+et8+et9,t236,t231,t235,t234,t228,t236,et10+et11+et12,t230,t237,t227,t240,t231,t230,et13+et14+et15,t232,t239,t229,t235,t237,t232,et16+et17+et18],(6,6))

        return dW_da3

    def dW_da3_fcn(self, x, a):
        # Current W does not depend on a[3]
        return np.zeros((6,6))

    def dW_dai_fcn(self, i, x, a):
        if i == 0:
            return self.dW_da0_fcn(x, a)
        elif i == 1:
            return self.dW_da1_fcn(x, a)
        elif i == 2:
            return self.dW_da2_fcn(x, a)
        elif i == 3:
            return self.dW_da3_fcn(x, a)
        else:
            return np.zeros((6, 6))
        #TODO: raise error when i > uncertainty parameter's dimension