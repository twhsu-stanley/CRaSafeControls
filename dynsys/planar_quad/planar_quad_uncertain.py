import sympy as sp
import numpy as np
from dynsys.ctrl_affine_sys import CtrlAffineSys

class PLANAR_QUAD_UNCERTAIN(CtrlAffineSys):
    def __init__(self, params=None):
        super().__init__(params)
    
    def define_system_symbolic(self):
        # Symbolic states
        px, pz, phi, vx, vz, phi_dot = sp.symbols('px pz phi vx vz phi_dot')
        x = sp.Matrix([px, pz, phi, vx, vz, phi_dot])
        
        l = self.params['l'] # (m) half-width of quadrotor
        m = self.params['m'] # (kg) mass of the quadrotor
        grav = self.params['g'] # (m/s^2) gravity
        J = self.params['J'] # (kgm^2), moment of inertia

        f = sp.Matrix([
            x[3] * sp.cos(x[2]) - x[4] * sp.sin(x[2]),   # px_dot
            x[3] * sp.sin(x[2]) + x[4] * sp.cos(x[2]),   # pz_dot
            x[5],                                        # phi_dot
            x[5] * x[4] - grav * sp.sin(x[2]),           # vx_dot
            -x[5] * x[3] - grav * sp.cos(x[2]),          # vz_dot
            sp.Integer(0)                                # phi_ddot
        ])

        g = sp.Matrix([
            [0,              0],
            [0,              0],
            [0,              0],
            [0,              0],
            [1/m,            1/m],
            [l/J,           -l/J]
        ])

        # Define the symbolic uncertainty term Y(x)
        Y = sp.Matrix([[0], 
                       [0],
                       [0],
                       [sp.cos(x[2])],
                       [-sp.sin(x[2])],
                       [0]])
        
        # Define symbolic uncertainty parameters
        a0 = sp.symbols('a0')
        a = sp.Matrix([a0])

        return x, f, g, Y, a

    # CCM functions generated by SOS in MATLAB
    # Converting MATLAB functions to Python functions: 
    #   in1(k,:) => x[k-1]
    #    *  => *
    #    **  => **
    #   remove all semicolons

    def W_fcn(self, x, a1):
        #W_fcn
        #    W_fcn = W_fcn(IN1,A1)

        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    20-Feb-2026 02:33:23

        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a1 ** 3
        t5 = x3 ** 2
        t6 = x3 ** 3
        t7 = x4 ** 2
        t9 = x4 ** 3
        t11 = x4 * 2.53593137716e-2
        t13 = x3 * 1.37780971653e-1
        t14 = x3 * 3.70173149036e-1
        t16 = x3 * 2.5714322566e-1
        t17 = a1 * x3 * 5.21797519969e-3
        t18 = x4 * 7.972479128279999e-2
        t19 = a1 * 2.02691731309e-2
        t20 = x4 * 4.17749996679e-3
        t21 = x4 * 9.869401038410001e-3
        t22 = a1 * x3 * 1.84150270218e-3
        t24 = x3 * 8.82694797769e-3
        t25 = x3 * 2.20420857054e-2
        t26 = x4 * 1.8274079192e-2
        t28 = x3 * 3.16736016706e-2
        t30 = a1 * 2.381503806e-2
        t31 = a1 * 2.08307941465e-3
        t33 = a1 * 1.04278868311e-2
        t35 = x3 * 3.61116394843e-3
        t36 = a1 * x3 * 1.28164716966e-2
        t37 = x3 * x4 * 1.04566747168e-2
        t38 = x3 * x4 * 1.71565828843e-2
        t40 = x3 * x4 * 1.68707795462e-2
        t42 = x4 * 1.4504972986e-2
        t43 = x3 * x4 * 2.08342239135e-2
        t44 = a1 * 1.31519933177e-2
        t47 = x4 * 2.77306264606e-3
        t51 = x4 * 4.54323645793e-3
        t52 = a1 * 1.44607111693e-3
        t53 = a1 * 5.49341028508e-3
        t56 = a1 * 1.92972474812e-3
        t57 = x3 * x4 * 1.10896923572e-2
        t60 = x3 * 8.9223227912e-4
        t64 = a1 * x3 * x4 * 6.8130700781e-4
        t65 = x3 * x4 * 7.78710445803e-3
        t66 = a1 * x3 * 1.43994958972e-3
        t68 = a1 * x3 * 1.32846005803e-3
        t72 = a1 * x4 * 9.887894042810001e-4
        t75 = a1 * x4 * 2.14209846399e-3
        t76 = a1 * x3 * 8.98181928325e-3
        t77 = a1 * x4 * 3.11937886912e-4
        t78 = a1 * x4 * 1.26035361195e-3
        t80 = a1 * x3 * 1.23028493801e-3
        t86 = a1 * x4 * 9.86685117967e-4
        t107 = a1 * x3 * x4 * 7.39026465542e-4
        t110 = a1 * x3 * x4 * 3.92091760756e-3
        t127 = a1 * x4 * 7.43249177622e-4
        t130 = x3 * x4 * 8.97930658057e-4
        t165 = a1 * x3 * x4 * 2.90811164684e-4
        t173 = a1 * x3 * x4 * 1.95444335889e-4
        t175 = a1 * x3 * x4 * 2.28162662495e-4
        t176 = a1 * x3 * x4 * 1.91362948978e-4
        t181 = a1 * x4 * 1.33064476382e-5
        t189 = a1 * x3 * x4 * 1.94280963798e-4
        t4 = t2 ** 2
        t8 = t5 ** 2
        t10 = t7 ** 2
        t12 = t5 * 5.55748631413e-3
        t23 = -t13
        t29 = -t16
        t32 = -t18
        t34 = -t19
        t39 = -t20
        t41 = t6 * 3.09376670681e-2
        t45 = -t24
        t46 = -t25
        t48 = -t26
        t49 = t5 * 1.75083826238e-1
        t50 = -t28
        t54 = -t31
        t55 = t3 * 3.49097696918e-3
        t58 = t3 * 2.87815917087e-2
        t59 = -t35
        t61 = -t36
        t62 = t5 * 2.9830275249e-2
        t69 = -t42
        t70 = -t44
        t71 = t3 * 6.04466077347e-3
        t73 = t5 * 1.18589060953e-1
        t74 = -t47
        t79 = a1 * t5 * 3.77136512943e-3
        t81 = t5 * 2.83093512307e-2
        t82 = t2 * 3.55346670088e-2
        t83 = -t52
        t84 = t3 * 2.1498160151e-3
        t85 = t5 * 2.22386514187e-2
        t87 = -t57
        t88 = t9 * x3 * 6.48477342138e-4
        t89 = t6 * 3.95719342815e-2
        t90 = t3 * 1.833328217e-2
        t91 = t5 * 5.77827384233e-3
        t92 = t5 * x4 * 9.97788206087e-3
        t93 = t2 * x3 * 2.44479012119e-2
        t95 = t7 * 1.03596173381e-3
        t96 = t3 * x4 * 5.26796943515e-4
        t98 = a1 * t9 * 9.88538453119e-5
        t101 = t7 * 6.73783543688e-3
        t102 = t2 * x4 * 4.38301521521e-3
        t104 = t2 * 5.85241324701e-4
        t105 = t3 * 3.67373261096e-3
        t106 = t6 * 3.3066125424e-3
        t108 = t9 * 1.30517427109e-3
        t109 = t2 * x3 * 2.38425544186e-2
        t111 = -t68
        t112 = t6 * 3.89570120167e-3
        t113 = t3 * 1.18044415412e-3
        t114 = t5 * x4 * 2.42443341861e-2
        t116 = t2 * x3 * 2.47537621573e-2
        t117 = t6 * 1.47220437014e-2
        t118 = -t72
        t119 = t2 * 3.53657906233e-3
        t120 = -t75
        t121 = -t78
        t122 = -t80
        t124 = t3 * x3 * 4.25222606595e-3
        t126 = t2 * x3 * 1.14036809455e-2
        t131 = t2 * x4 * 8.34489053171e-3
        t132 = t3 * 1.63705514397e-3
        t134 = t2 * 1.27200346963e-3
        t135 = a1 * t6 * 2.49382977901e-4
        t136 = t9 * 1.22588729618e-3
        t138 = t7 * 3.83518419591e-3
        t139 = t2 * x3 * 4.63729129449e-3
        t141 = t2 * x4 * 7.40343870623e-3
        t142 = t7 * 2.40582366698e-3
        t144 = t9 * 9.773632168529999e-4
        t148 = a1 * t7 * 8.30110925319e-4
        t151 = a1 * t7 * 4.60640931172e-4
        t152 = t5 * x4 * 9.556121159009999e-4
        t154 = t6 * x4 * 1.15579992363e-3
        t156 = t6 * x4 * 3.89131519017e-4
        t157 = t7 * 5.9437838577e-4
        t158 = t5 * t7 * 6.66887328278e-4
        t161 = a1 * t7 * 4.05076016697e-4
        t162 = t7 * x3 * 1.33166358512e-3
        t163 = a1 * t6 * 1.3603014278e-3
        t164 = t2 * 7.35195822032e-4
        t166 = t7 * 2.33469172409e-4
        t170 = t9 * 1.52438759109e-4
        t171 = t7 * 8.60296650285e-4
        t174 = t6 * 4.56324784091e-4
        t177 = -t107
        t179 = t2 * 2.42401984508e-4
        t180 = a1 * t5 * 1.372247697e-3
        t182 = -t110
        t183 = a1 * t5 * 2.88031815787e-3
        t184 = a1 * t5 * 1.17989422987e-3
        t185 = t2 * x4 * 1.49267151268e-3
        t186 = t6 * x4 * 3.0961176817e-3
        t187 = a1 * t5 * 1.82858282535e-3
        t188 = t5 * x4 * 4.06836632859e-3
        t190 = t3 * x3 * 2.75097375465e-3
        t191 = t2 * 7.659107952510001e-5
        t192 = t3 * x3 * 3.06865185902e-3
        t194 = a1 * t7 * 5.26267049879e-4
        t195 = t5 * x4 * 1.17484466522e-3
        t196 = t6 * x4 * 1.73405132693e-3
        t198 = t9 * 8.84443680201e-4
        t199 = t7 * x3 * 3.16701065126e-3
        t200 = t3 * x3 * 5.91979189837e-3
        t201 = t3 * x4 * 9.824541295059999e-4
        t203 = t5 * x4 * 2.80330510507e-3
        t204 = t7 * x3 * 7.43277348853e-3
        t206 = t3 * x4 * 1.97168836094e-3
        t207 = a1 * t9 * 2.04625613543e-4
        t208 = -t127
        t209 = t2 * x3 * 5.78698175544e-3
        t211 = -t130
        t213 = a1 * t6 * 1.03940280422e-3
        t214 = a1 * t5 * 5.80646528128e-3
        t215 = t9 * 6.39909201008e-4
        t216 = t2 * x4 * 5.44346095025e-4
        t218 = t6 * x4 * 1.46212445362e-3
        t220 = t7 * x3 * 8.32723906342e-3
        t221 = t6 * 4.21878317583e-4
        t222 = t6 * x4 * 1.08395622332e-3
        t223 = t5 * x4 * 8.820091710059999e-4
        t225 = t5 * x4 * 8.494646760239999e-3
        t226 = t2 * x3 * 1.04417225784e-2
        t227 = t3 * x3 * 7.18255079484e-3
        t228 = t6 * x4 * 1.2460843222e-3
        t229 = t6 * 5.58669996902e-4
        t230 = a1 * t5 * 1.24599907287e-3
        t231 = t9 * x3 * 8.769281809490001e-4
        t233 = t9 * 2.15072034612e-4
        t235 = t3 * x4 * 2.15112178433e-3
        t236 = t2 * x3 * 8.400830387630001e-3
        t240 = t7 * x3 * 5.03323672389e-4
        t244 = t7 * x3 * 2.86222298801e-4
        t246 = a1 * t7 * 9.63145318831e-5
        t251 = -t165
        t253 = t3 * x3 * 8.90119725032e-4
        t254 = t2 * x3 * x4 * 8.263052266270001e-3
        t255 = a1 * t7 * x3 * 2.73229745849e-4
        t256 = t2 * x4 * 6.41708063579e-4
        t258 = t2 * t5 * 3.05488282116e-2
        t259 = t2 * x4 * 2.40634156322e-4
        t260 = -t175
        t261 = t3 * x3 * 4.29914492055e-4
        t262 = t2 * x4 * 8.48091525904e-4
        t265 = t3 * x4 * 8.19135161296e-5
        t267 = a1 * t7 * x3 * 4.06623161362e-4
        t268 = t3 * x4 * 3.88903724245e-4
        t269 = t7 * x3 * 1.10437946254e-4
        t272 = -t189
        t273 = t9 * 9.07313734915e-6
        t274 = a1 * t6 * 2.7543699419e-4
        t275 = a1 * t6 * 1.99178672963e-4
        t276 = t2 * t5 * 2.98480470505e-2
        t277 = a1 * t9 * 1.21454581739e-4
        t281 = t2 * t5 * 1.4951484809e-2
        t284 = t2 * x3 * x4 * 3.29006833123e-3
        t285 = a1 * t6 * 6.418218739630001e-4
        t287 = t9 * x3 * 2.56133228468e-4
        t288 = t9 * x3 * 2.0878854442e-4
        t289 = t2 * x3 * x4 * 2.77298158559e-3
        t291 = a1 * t5 * 1.63232464648e-4
        t292 = a1 * t7 * 2.58917933463e-4
        t293 = t2 * x3 * x4 * 9.777765864580001e-4
        t295 = t9 * x3 * 9.50613526143e-4
        t296 = t7 * x3 * 6.0781977623e-4
        t297 = t3 * x4 * 2.43850299205e-4
        t303 = t9 * x3 * 2.18985038646e-4
        t305 = t2 * x3 * x4 * 4.60912898728e-3
        t306 = t9 * x3 * 5.4024674893e-5
        t311 = t2 * t7 * 2.11671084628e-3
        t313 = t2 * t5 * 2.8428326442e-3
        t314 = a1 * t9 * 1.41682269802e-5
        t316 = a1 * t5 * x4 * 7.10634569733e-4
        t317 = t2 * t5 * 4.68247471036e-3
        t318 = t2 * t5 * 8.90451108871e-3
        t319 = a1 * t5 * x4 * 6.70084804433e-4
        t320 = a1 * t7 * 1.75632202526e-5
        t321 = t2 * t7 * 1.18119749581e-3
        t322 = t2 * x3 * x4 * 3.57891016998e-4
        t325 = t5 * t7 * 5.98442436041e-4
        t327 = t5 * t7 * 2.3012100376e-3
        t328 = a1 * t7 * 3.27314436926e-5
        t329 = a1 * t9 * 7.774243407619999e-5
        t331 = a1 * t9 * 1.30362012953e-5
        t335 = a1 * t5 * x4 * 3.34757964809e-4
        t338 = a1 * t6 * 5.02890918298e-5
        t339 = t2 * x3 * x4 * 6.88113073685e-4
        t342 = t2 * t7 * 5.89000964998e-3
        t344 = a1 * t5 * x4 * 5.55868560029e-4
        t348 = a1 * t9 * 4.18638321998e-5
        t349 = a1 * t7 * x3 * 6.11908127831e-4
        t350 = t5 * t7 * 5.04125572727e-4
        t352 = a1 * t7 * x3 * 1.85730730325e-4
        t353 = a1 * t5 * x4 * 2.74851887298e-4
        t357 = t2 * t7 * 6.45632052241e-4
        t359 = a1 * t7 * x3 * 2.26537381189e-5
        t360 = a1 * t7 * x3 * 9.48789115328e-5
        t362 = t5 * t7 * 1.72662883112e-4
        t363 = t2 * t7 * 3.20934815674e-4
        t365 = a1 * t5 * x4 * 1.09340400782e-5
        t366 = t5 * t7 * 4.82504506969e-4
        t367 = t2 * t5 * 1.6789215824e-4
        t368 = t5 * t7 * 8.89474273119e-5
        t369 = t2 * t7 * 2.66918777444e-4
        t370 = a1 * t5 * x4 * 7.465380685350001e-5
        t371 = a1 * t7 * x3 * 1.80826854945e-5
        t374 = t2 * t7 * 2.29853776244e-4
        t15 = t8 * 3.51508986554e-3
        t63 = t4 * 2.9350310627e-2
        t67 = t4 * 2.84746761137e-2
        t94 = t8 * 1.5625486605e-3
        t97 = -t62
        t99 = t8 * 3.1292174314e-3
        t100 = t8 * 1.11495508861e-3
        t103 = t4 * 2.14443184294e-3
        t115 = -t71
        t123 = -t81
        t125 = t8 * 2.45544538291e-4
        t128 = t8 * 1.45499124719e-3
        t129 = -t82
        t133 = t4 * 1.11003417719e-2
        t137 = t4 * 1.63023334536e-3
        t140 = t4 * 1.11215358643e-3
        t143 = -t88
        t145 = -t89
        t146 = -t90
        t147 = -t91
        t149 = -t92
        t150 = t10 * 1.53961685481e-4
        t153 = -t93
        t159 = -t96
        t168 = -t101
        t169 = -t102
        t178 = -t108
        t193 = t8 * 4.04437686645e-4
        t197 = -t119
        t202 = t4 * 8.40426663368e-4
        t212 = -t131
        t217 = -t132
        t219 = -t134
        t224 = -t136
        t232 = -t138
        t234 = t10 * 5.21809205071e-4
        t237 = -t144
        t238 = t10 * 1.85020707359e-4
        t239 = -t148
        t241 = -t154
        t242 = t10 * 4.93605280199e-5
        t243 = -t157
        t245 = t10 * 2.25282825651e-5
        t247 = -t161
        t248 = -t162
        t249 = -t163
        t250 = -t164
        t252 = -t166
        t257 = -t170
        t263 = -t179
        t264 = -t180
        t266 = -t183
        t270 = -t186
        t271 = -t188
        t279 = -t194
        t280 = -t196
        t282 = t10 * 7.5826557138e-5
        t283 = -t198
        t286 = -t199
        t294 = -t209
        t298 = t10 * 7.72794305029e-5
        t299 = -t214
        t300 = -t215
        t301 = -t218
        t302 = -t222
        t304 = -t226
        t307 = -t230
        t308 = -t231
        t309 = -t233
        t310 = -t236
        t315 = -t256
        t323 = -t262
        t324 = -t267
        t326 = -t269
        t330 = -t274
        t332 = -t281
        t334 = -t284
        t336 = -t287
        t337 = -t288
        t340 = -t289
        t341 = -t291
        t343 = -t295
        t345 = -t296
        t346 = -t297
        t351 = -t305
        t354 = -t311
        t355 = -t313
        t356 = -t317
        t358 = -t320
        t361 = -t325
        t364 = -t335
        t372 = -t348
        t373 = -t349
        t375 = -t352
        t376 = -t359
        t377 = -t363
        t378 = -t365
        t379 = -t366
        t380 = -t367
        t381 = -t370
        t382 = -t371
        t27 = -t15
        t155 = -t94
        t160 = -t99
        t167 = -t100
        t172 = -t103
        t205 = -t125
        t210 = -t128
        t278 = -t193
        t290 = -t202
        t312 = -t245
        t333 = -t282
        t347 = -t298
        t383 = t14+t21+t55+t70+t79+t126+t145+t149+t151+t212+t237+t260+t286
        t384 = t23+t32+t33+t84+t114+t116+t117+t141+t182+t220+t224+t239+t299
        t385 = t29+t34+t41+t58+t64+t69+t187+t204+t225+t247+t283+t294+t323
        t386 = t11+t46+t53+t109+t112+t169+t176+t178+t217+t266+t271+t292+t326
        t387 = t48+t50+t56+t106+t113+t203+t216+t244+t264+t272+t309+t310+t328
        t388 = t30+t51+t60+t146+t152+t173+t185+t221+t248+t273+t304+t307+t358
        t389 = t45+t54+t74+t115+t153+t174+t177+t184+t223+t279+t300+t315+t345
        t390 = t39+t59+t83+t105+t139+t195+t229+t240+t246+t251+t257+t259+t341
        t391 = t27+t43+t49+t61+t63+t121+t142+t150+t197+t200+t235+t258+t270+t285+t303+t316+t321+t329+t351+t362+t375-4.74622759176e-1
        t392 = t38+t66+t67+t73+t129+t143+t160+t206+t208+t227+t234+t243+t276+t280+t324+t327+t330+t334+t342+t344+t372-2.4758072165e-1
        t393 = t65+t85+t98+t104+t111+t158+t159+t172+t181+t192+t210+t213+t232+t302+t308+t318+t319+t333+t340+t354+t373-3.43383480904e-2
        t394 = t40+t76+t120+t123+t124+t133+t168+t201+t205+t207+t238+t249+t250+t254+t301+t343+t350+t356+t357+t378+t382+9.451552576e-2
        t395 = t22+t37+t118+t135+t140+t147+t155+t190+t219+t241+t252+t255+t268+t277+t322+t332+t336+t347+t353+t374+t379-6.49170256849e-2
        t396 = t12+t77+t122+t137+t156+t171+t191+t211+t242+t261+t265+t278+t293+t306+t314+t338+t368+t369+t376+t380+t381-1.91736034369e-2
        t397 = t17+t86+t87+t95+t97+t167+t228+t253+t263+t275+t290+t312+t331+t337+t339+t346+t355+t360+t361+t364+t377+1.01017368295e-1
        et1 = t2 * 1.038248656e-2-t4 * 5.69280741686e-2-t5 * 7.92269500636e-4-t7 * 7.53243379099e-4-t8 * 1.99840516384e-3
        et2 = t10 * (-4.66348427169e-5)+a1 * t6 * 2.85981223021e-4+a1 * t9 * 1.17163002184e-5+a1 * x3 * 1.83065331238e-3+a1 * x4 * 9.43458196861e-4
        et3 = t2 * t5 * (-1.94262977271e-2)-t2 * t7 * 3.0568106337e-4-t5 * t7 * 7.18417162122e-5-t3 * x3 * 2.77730026305e-3
        et4 = t3 * x4 * (-2.84655784098e-3)-t6 * x4 * 2.80776067901e-3-t9 * x3 * 9.08484115361e-4-x3 * x4 * 7.15418209388e-3
        et5 = a1 * t5 * x4 * (-8.63541332174e-4)-a1 * t7 * x3 * 1.5726663959e-4-t2 * x3 * x4 * 2.79800805104e-3+4.96527052549e-1
        et6 = t2 * 1.27930753741e-1-t4 * 4.48417899702e-1+t5 * 1.33909802458e-2+t7 * 1.24443086116e-3-t8 * 1.99607553133e-3
        et7 = t10 * 7.88801497409e-6+a1 * t6 * 6.2552973165e-4-a1 * t9 * 4.41282945647e-5-a1 * x3 * 9.34298088107e-5
        et8 = a1 * x4 * 5.808420122e-3-t2 * t5 * 1.78221696523e-2-t2 * t7 * 4.60264849671e-4-t5 * t7 * 5.36171766914e-4+t3 * x3 * 4.26501817812e-3
        et9 = t3 * x4 * (-1.79045033138e-2)-t6 * x4 * 1.20672147011e-4-t9 * x3 * 1.24203508556e-3-x3 * x4 * 1.63028934344e-2-a1 * t5 * x4 * 8.52931907336e-4
        et10 = a1 * t7 * x3 * (-3.74761452267e-4)+t2 * x3 * x4 * 4.61125504766e-3+2.42682422145e-1
        et11 = t2 * 2.47938242312e-4+t4 * 2.82069817947e-5-t5 * 3.66754485574e-3+t7 * 2.60162918539e-4+t8 * 1.10751138924e-4
        et12 = t10 * 8.23488356113e-6-a1 * t6 * 5.65670006497e-5-a1 * t9 * 5.6828551057e-6+a1 * x3 * 6.7863147141e-4
        et13 = a1 * x4 * 4.90685092329e-5+t2 * t5 * 6.16870346126e-4-t2 * t7 * 1.14441080138e-4-t5 * t7 * 1.31237346978e-4
        et14 = t3 * x3 * (-4.73995329151e-5)-t3 * x4 * 1.60271748442e-4+t6 * x4 * 1.37059260144e-4-t9 * x3 * 2.61470292864e-5
        et15 = x3 * x4 * (-1.01384786163e-3)-a1 * t5 * x4 * 5.2795522554e-5+a1 * t7 * x3 * 2.68568879786e-5+t2 * x3 * x4 * 1.00436118652e-3+3.74207145456e-2
        et16 = t2 * (-2.17968609109e-3)-t4 * 7.15636059556e-3-t5 * 1.22557102054e-1+t7 * 1.02908095407e-3+t8 * 4.47700438757e-4
        et17 = t10 * (-9.30952993022e-5)-a1 * t6 * 1.87373781472e-3+a1 * t9 * 1.72313293729e-4+a1 * x3 * 2.19974548707e-2+a1 * x4 * 1.13675522249e-2
        et18 = t2 * t5 * 7.97653639968e-4-t2 * t7 * 1.94279464878e-3+t5 * t7 * 3.66174523715e-3+t3 * x3 * 2.98409069187e-3-t3 * x4 * 1.16045620414e-3
        et19 = t6 * x4 * 8.009475277880001e-3-t9 * x3 * 2.02684123251e-3-x3 * x4 * 1.27535417849e-1-a1 * t5 * x4 * 2.67985640329e-3-a1 * t7 * x3 * 8.89393535199e-4
        et20 = t2 * x3 * x4 * 9.2353364426e-3+7.97786639833e-1
        et21 = t2 * 6.92047620686e-2+t4 * 9.81888630752e-3+t5 * 4.27496022825e-2+t7 * 8.708026975169999e-3-t8 * 1.23632555988e-3
        et22 = t10 * (-1.00135743162e-4)+a1 * t6 * 6.27359063033e-4-a1 * t9 * 4.05392076448e-5-a1 * x3 * 1.06683247665e-2
        et23 = a1 * x4 * (-3.48515718689e-4)-t2 * t5 * 3.74828688562e-3-t2 * t7 * 3.35252327994e-3-t5 * t7 * 1.30007288815e-3+t3 * x3 * 6.9714370492e-3
        et24 = t3 * x4 * (-4.35159722626e-3)-t6 * x4 * 1.29228802701e-3-t9 * x3 * 3.36197335938e-4+x3 * x4 * 2.38703164295e-2+a1 * t5 * x4 * 4.62190546677e-4
        et25 = a1 * t7 * x3 * 1.40924052225e-4-t2 * x3 * x4 * 6.16253815122e-3+5.82701769962e-1
        et26 = t2 * (-1.07286285589e-2)+t4 * 3.07671987828e-2-t5 * 4.55657762038e-2+t7 * 2.96484648594e-3+t8 * 2.03500595935e-3
        et27 = t10 * 3.27840259305e-4-a1 * t6 * 8.46114976071e-4+a1 * t9 * 7.39576694995e-6+a1 * x3 * 9.42739536481e-3-a1 * x4 * 1.220666648e-3
        et28 = t2 * t5 * 1.85913583798e-2-t2 * t7 * 1.35770536286e-3+t5 * t7 * 4.17891942435e-4-t3 * x3 * 1.59215596889e-2-t3 * x4 * 5.20360633916e-4
        et29 = t6 * x4 * (-1.37666676736e-3)-t9 * x3 * 5.68948845047e-4+x3 * x4 * 3.05540008653e-2+a1 * t5 * x4 * 6.42272757757e-4+a1 * t7 * x3 * 6.59287593756e-4
        et30 = t2 * x3 * x4 * (-2.08347622884e-2)+1.17329188791
        W_fcn = np.reshape([et1+et2+et3+et4+et5,t388,t396,t391,t383,t393,t388,et6+et7+et8+et9+et10,t390,t385,t392,t389,t396,t390,et11+et12+et13+et14+et15,t397,t387,t395,t391,t385,t397,et16+et17+et18+et19+et20,t384,t394,t383,t392,t387,t384,et21+et22+et23+et24+et25,t386,t393,t389,t395,t394,t386,et26+et27+et28+et29+et30],(6,6))
        return W_fcn

    def dW_dphi_fcn(self, x, a1):
        #dW_dphi
        #    dW_dphi = dW_dphi(IN1,A1)

        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    20-Feb-2026 02:33:29

        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a1 ** 3
        t4 = x3 ** 2
        t5 = x3 ** 3
        t6 = x4 ** 2
        t7 = x4 ** 3
        t10 = a1 * 1.281647169659389e-2
        t11 = x3 * 2.3717812190639e-1
        t12 = x3 * 3.501676524769344e-1
        t14 = x4 * 2.083422391347947e-2
        t15 = x3 * 4.447730283732539e-2
        t16 = x3 * 5.661870246134224e-2
        t17 = x4 * 1.715658288428344e-2
        t18 = x4 * 1.687077954619308e-2
        t19 = x3 * 5.966055049796826e-2
        t20 = x3 * x4 * 4.848866837218731e-2
        t21 = a1 * 8.981819283252658e-3
        t22 = x4 * 1.108969235719728e-2
        t23 = a1 * x4 * 2.281626624949682e-4
        t24 = a1 * x3 * 2.744495394001161e-3
        t25 = x3 * x4 * 8.136732657186719e-3
        t26 = x3 * 1.111497262826736e-2
        t27 = a1 * 1.841502702179635e-3
        t29 = a1 * 1.439949589716311e-3
        t30 = a1 * 5.217975199688681e-3
        t31 = x4 * 7.787104458027378e-3
        t34 = x3 * 1.155654768466134e-2
        t35 = x3 * x4 * 1.698929352048504e-2
        t36 = a1 * 1.3284600580309e-3
        t40 = a1 * x3 * 1.161293056255283e-2
        t41 = a1 * 1.230284938007356e-3
        t42 = x4 * 1.045667471679017e-2
        t43 = x3 * x4 * 1.995576412174689e-2
        t44 = a1 * x3 * 2.359788459737722e-3
        t45 = a1 * x3 * 3.657165650705441e-3
        t47 = x3 * x4 * 2.349689330437446e-3
        t52 = x4 * 8.979306580569956e-4
        t54 = a1 * x3 * 3.264649292966445e-4
        t56 = x3 * x4 * 1.764018342011532e-3
        t57 = a1 * x3 * 7.542730258854249e-3
        t59 = a1 * x4 * 3.920917607564683e-3
        t62 = a1 * x3 * 2.491998145748746e-3
        t64 = x3 * x4 * 1.911224231802774e-3
        t66 = a1 * x3 * 5.760636315738183e-3
        t68 = x3 * x4 * 5.606610210135034e-3
        t88 = a1 * x4 * 1.954443358890172e-4
        t90 = a1 * x3 * x4 * 1.111737120058203e-3
        t92 = a1 * x4 * 1.913629489781766e-4
        t93 = a1 * x4 * 7.390264655424691e-4
        t99 = a1 * x4 * 2.908111646836174e-4
        t104 = a1 * x3 * x4 * 1.340169608866063e-3
        t105 = a1 * x3 * x4 * 1.421269139466194e-3
        t109 = a1 * x4 * 6.813070078101317e-4
        t114 = a1 * x4 * 1.942809637984504e-4
        t126 = a1 * x3 * x4 * 6.695159296186652e-4
        t132 = a1 * x3 * x4 * 1.493076137069899e-4
        t139 = a1 * x3 * x4 * 5.497037745969318e-4
        t183 = a1 * x3 * x4 * 2.186808015646661e-5
        t8 = t2 * 2.444790121188589e-2
        t13 = -t10
        t28 = -t16
        t32 = t2 * x3 * 5.969609410095733e-2
        t33 = t4 * 4.416613110424167e-2
        t37 = t4 * 1.187158028444728e-1
        t38 = -t19
        t39 = t4 * x4 * 9.288353045106112e-3
        t46 = -t22
        t48 = -t23
        t49 = -t24
        t50 = -t25
        t51 = t6 * 7.432773488525054e-3
        t53 = t2 * 1.044172257836153e-2
        t55 = -t34
        t58 = t2 * 4.637291294494982e-3
        t60 = -t36
        t61 = t3 * 7.182550794841612e-3
        t65 = t2 * 8.400830387629774e-3
        t69 = -t40
        t70 = t2 * 2.384255441860242e-2
        t71 = t2 * x4 * 4.609128987279568e-3
        t72 = -t41
        t73 = -t43
        t74 = t2 * 2.475376215728614e-2
        t75 = t5 * 1.251686972559776e-2
        t76 = t6 * 2.862222988006321e-4
        t77 = t5 * 6.250194641982126e-3
        t78 = t3 * 5.919791898371375e-3
        t79 = t6 * 3.167010651262905e-3
        t80 = t5 * 4.459820354451837e-3
        t81 = t5 * 5.819964988747285e-3
        t82 = t2 * x3 * 6.109765642320332e-2
        t83 = t2 * 5.786981755436209e-3
        t84 = -t52
        t86 = -t54
        t87 = t2 * 1.140368094554372e-2
        t89 = t6 * 8.327239063422214e-3
        t91 = t3 * 4.25222606595387e-3
        t94 = -t59
        t95 = -t62
        t96 = t3 * 3.068651859016861e-3
        t97 = t2 * x4 * 8.263052266269669e-3
        t98 = t6 * 1.331663585122189e-3
        t101 = t5 * 1.406035946215783e-2
        t102 = -t66
        t103 = t4 * 9.281300120416013e-2
        t106 = t2 * x3 * 1.780902217741205e-2
        t107 = t5 * 1.617750746581875e-3
        t108 = t6 * x3 * 4.602420075191013e-3
        t110 = t3 * 2.750973754654502e-3
        t111 = t2 * x3 * 2.990296961790221e-2
        t113 = t5 * 9.821781531651303e-4
        t116 = t7 * 2.561332284679183e-4
        t117 = t4 * x4 * 3.251868669959282e-3
        t119 = t7 * 8.769281809488377e-4
        t120 = t7 * 2.087885444196186e-4
        t123 = t2 * x4 * 2.772981585592439e-3
        t125 = t4 * 1.168710360500765e-2
        t127 = t2 * x4 * 9.777765864584342e-4
        t129 = t7 * 9.506135261427216e-4
        t130 = t6 * 6.07819776229956e-4
        t131 = t2 * x3 * 3.35784316480356e-4
        t133 = t7 * 2.189850386456379e-4
        t134 = t6 * x3 * 1.008251145454303e-3
        t135 = t3 * 4.299144920554518e-4
        t136 = -t93
        t137 = t4 * 9.919837627189357e-3
        t138 = t6 * x3 * 1.333774656555525e-3
        t140 = t6 * 5.033236723890291e-4
        t141 = t2 * x4 * 3.290068331231388e-3
        t142 = t6 * 1.104379462538485e-4
        t144 = -t99
        t145 = t2 * x3 * 5.685665288399909e-3
        t146 = t3 * 8.901197250323851e-4
        t147 = t7 * 6.484773421380391e-4
        t149 = t2 * x3 * 9.364949420710597e-3
        t150 = t6 * x3 * 1.196884872081109e-3
        t153 = a1 * t6 * 6.119081278308728e-4
        t154 = t6 * x3 * 9.650090139375496e-4
        t156 = -t114
        t161 = t2 * x4 * 6.881130736851919e-4
        t163 = -t126
        t164 = a1 * t4 * 4.080904283403881e-3
        t166 = t4 * x4 * 3.738252966601605e-3
        t168 = t4 * 1.368974352274323e-3
        t170 = t4 * 1.676009990707427e-3
        t171 = -t132
        t172 = a1 * t4 * 3.1182084126579e-3
        t173 = a1 * t6 * 2.732297458486745e-4
        t174 = a1 * t6 * 1.85730730325113e-4
        t175 = a1 * t4 * 5.975360188893911e-4
        t176 = t6 * x3 * 3.453257662249092e-4
        t178 = t4 * 1.265634952747845e-3
        t181 = t2 * x4 * 3.578910169976219e-4
        t184 = a1 * t6 * 4.066231613622236e-4
        t186 = t4 * x4 * 3.467399770901498e-3
        t188 = t7 * 5.402467489301217e-5
        t189 = a1 * t4 * 8.263109825688641e-4
        t191 = t4 * x4 * 4.386373360874665e-3
        t193 = t6 * x3 * 1.778948546238276e-4
        t194 = t4 * x4 * 5.202153980791059e-3
        t196 = t4 * x4 * 1.167394557050784e-3
        t198 = a1 * t4 * 1.925465621888194e-3
        t199 = a1 * t6 * 2.265373811893391e-5
        t200 = -t183
        t201 = a1 * t6 * 1.808268549446895e-5
        t203 = a1 * t4 * 7.481489337020127e-4
        t205 = a1 * t6 * 9.487891153283765e-5
        t210 = a1 * t4 * 1.508672754894327e-4
        t9 = -t8
        t63 = -t37
        t67 = -t39
        t85 = -t53
        t100 = -t65
        t112 = -t71
        t115 = -t75
        t118 = -t77
        t121 = -t79
        t122 = -t80
        t124 = -t81
        t128 = -t83
        t143 = -t98
        t148 = -t101
        t151 = -t107
        t152 = -t111
        t155 = -t113
        t157 = -t116
        t158 = -t117
        t159 = -t119
        t160 = -t120
        t162 = -t123
        t165 = -t129
        t167 = -t130
        t169 = -t131
        t177 = -t141
        t179 = -t142
        t180 = -t145
        t182 = -t147
        t185 = -t149
        t187 = -t150
        t190 = -t153
        t192 = -t154
        t195 = -t164
        t197 = -t174
        t202 = -t184
        t204 = -t186
        t206 = -t189
        t207 = -t191
        t208 = -t194
        t209 = -t199
        t211 = -t201
        t212 = t20+t33+t69+t74+t89+t94-1.3778097165274e-1
        t219 = t47+t58+t86+t140+t144+t170-3.611163948433443e-3
        t213 = t48+t57+t63+t73+t87+t121+3.701731490358567e-1
        t214 = t35+t45+t51+t103+t109+t128-2.571432256598076e-1
        t215 = t9+t44+t56+t136+t167+t168-8.826947977686886e-3
        t216 = t49+t68+t76+t100+t137+t156-3.167360167061688e-2
        t217 = t50+t70+t92+t102+t125+t179-2.204208570538704e-2
        t218 = t64+t85+t88+t95+t143+t178+8.922322791195267e-4
        t220 = t12+t13+t14+t67+t78+t82+t105+t112+t133+t148+t176+t197+t198
        t221 = t11+t17+t29+t32+t61+t90+t108+t115+t177+t182+t202+t206+t208
        t222 = t15+t31+t60+t96+t104+t106+t124+t138+t158+t159+t162+t172+t190
        t223 = t27+t42+t55+t110+t118+t139+t152+t157+t173+t181+t192+t203+t204
        t224 = t18+t21+t28+t91+t97+t134+t155+t165+t185+t195+t200+t207+t211
        t225 = t30+t38+t46+t122+t146+t160+t161+t163+t166+t175+t180+t187+t205
        t226 = t26+t72+t84+t127+t135+t151+t169+t171+t188+t193+t196+t209+t210
        et1 = a1 * 1.83065331238009e-3-t3 * 2.777300263050306e-3-t5 * 7.993620655379362e-3-t7 * 9.084841153614238e-4-x3 * 1.584539001271815e-3
        et2 = x4 * (-7.154182093878335e-3)+a1 * t4 * 8.579436690621956e-4-a1 * t6 * 1.572666395902053e-4-t2 * x3 * 3.885259545413728e-2-t2 * x4 * 2.798008051039181e-3
        et3 = t4 * x4 * (-8.423282037024749e-3)-t6 * x3 * 1.43683432424383e-4-a1 * x3 * x4 * 1.72708266434705e-3
        et4 = a1 * (-9.342980881069625e-5)+t3 * 4.265018178118271e-3-t5 * 7.984302125324071e-3-t7 * 1.242035085556665e-3+x3 * 2.678196049157636e-2
        et5 = x4 * (-1.630289343440822e-2)+a1 * t4 * 1.876589194949168e-3-a1 * t6 * 3.747614522670539e-4-t2 * x3 * 3.564433930452128e-2+t2 * x4 * 4.611255047662506e-3
        et6 = t4 * x4 * (-3.620164410320144e-4)-t6 * x3 * 1.07234353382777e-3-a1 * x3 * x4 * 1.705863814672568e-3
        et7 = a1 * 6.786314714104997e-4-t3 * 4.739953291506031e-5+t5 * 4.43004555694545e-4-t7 * 2.614702928639338e-5-x3 * 7.335089711483307e-3
        et8 = x4 * (-1.013847861633722e-3)-a1 * t4 * 1.697010019492255e-4+a1 * t6 * 2.685688797857836e-5+t2 * x3 * 1.233740692251133e-3
        et9 = t2 * x4 * 1.004361186518569e-3+t4 * x4 * 4.111777804329663e-4-t6 * x3 * 2.624746939568572e-4-a1 * x3 * x4 * 1.055910451079171e-4
        et10 = a1 * 2.19974548706558e-2+t3 * 2.984090691870805e-3+t5 * 1.790801755027407e-3-t7 * 2.026841232512469e-3-x3 * 2.451142041081948e-1
        et11 = x4 * (-1.275354178491599e-1)-a1 * t4 * 5.621213444170534e-3-a1 * t6 * 8.89393535199367e-4+t2 * x3 * 1.59530727993605e-3+t2 * x4 * 9.235336442599197e-3
        et12 = t4 * x4 * 2.402842583364829e-2+t6 * x3 * 7.323490474291332e-3-a1 * x3 * x4 * 5.359712806583117e-3
        et13 = a1 * (-1.066832476645968e-2)+t3 * 6.971437049202928e-3-t5 * 4.945302239529957e-3-t7 * 3.361973359383337e-4+x3 * 8.549920456506288e-2
        et14 = x4 * 2.38703164295028e-2+a1 * t4 * 1.882077189099852e-3+a1 * t6 * 1.40924052224842e-4-t2 * x3 * 7.49657377123404e-3-t2 * x4 * 6.162538151224985e-3
        et15 = t4 * x4 * (-3.876864081015434e-3)-t6 * x3 * 2.600145776301757e-3+a1 * x3 * x4 * 9.24381093353142e-4
        et16 = a1 * 9.427395364811721e-3-t3 * 1.592155968887463e-2+t5 * 8.14002383741463e-3-t7 * 5.689488450466145e-4-x3 * 9.113155240766407e-2
        et17 = x4 * 3.055400086533579e-2-a1 * t4 * 2.53834492821425e-3+a1 * t6 * 6.592875937562529e-4+t2 * x3 * 3.718271675963673e-2-t2 * x4 * 2.083476228841e-2
        et18 = t4 * x4 * (-4.130000302068269e-3)+t6 * x3 * 8.357838848696087e-4+a1 * x3 * x4 * 1.284545515514548e-3
        dW_dphi = np.reshape([et1+et2+et3,t218,t226,t220,t213,t222,t218,et4+et5+et6,t219,t214,t221,t215,t226,t219,et7+et8+et9,t225,t216,t223,t220,t214,t225,et10+et11+et12,t212,t224,t213,t221,t216,t212,et13+et14+et15,t217,t222,t215,t223,t224,t217,et16+et17+et18],(6,6))
        
        return dW_dphi
    
    def dW_dvx_fcn(self, x, a1):
        #dW_dvx
        #    dW_dvx = dW_dvx(IN1,A1)

        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    20-Feb-2026 02:33:31

        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a1 ** 3
        t4 = x3 ** 2
        t5 = x3 ** 3
        t6 = x4 ** 2
        t7 = x4 ** 3
        t9 = x4 * 1.720593300570391e-3
        t10 = x3 * 2.083422391347947e-2
        t11 = x4 * 4.811647333951796e-3
        t12 = x4 * 1.347567087376371e-2
        t14 = x3 * 1.715658288428344e-2
        t15 = x3 * 1.687077954619308e-2
        t17 = a1 * 2.142098463985122e-3
        t18 = a1 * 1.260353611954313e-3
        t19 = x3 * 1.108969235719728e-2
        t20 = a1 * x3 * 2.281626624949682e-4
        t21 = x4 * 2.071923467618855e-3
        t22 = a1 * 9.887894042806616e-4
        t23 = x3 * x4 * 1.486554697705011e-2
        t24 = x4 * 1.188756771539745e-3
        t25 = x3 * 7.787104458027378e-3
        t26 = x3 * x4 * 1.665447812684443e-2
        t27 = a1 * 7.432491776221308e-4
        t28 = x4 * 7.670368391821814e-3
        t29 = a1 * 9.866851179667869e-4
        t30 = x3 * 1.045667471679017e-2
        t31 = a1 * x4 * 1.660221850638125e-3
        t32 = a1 * x4 * 9.212818623436216e-4
        t33 = a1 * x4 * 1.052534099757498e-3
        t37 = x3 * x4 * 5.724445976012641e-4
        t39 = x3 * 8.979306580569956e-4
        t40 = x3 * x4 * 6.33402130252581e-3
        t42 = x4 * 4.669383448178743e-4
        t44 = x3 * x4 * 1.215639552459912e-3
        t47 = a1 * x3 * 3.920917607564683e-3
        t48 = x3 * x4 * 1.006647344778058e-3
        t51 = x3 * x4 * 2.663327170244379e-3
        t52 = a1 * 3.119378869122657e-4
        t55 = a1 * x3 * x4 * 1.223816255661746e-3
        t67 = a1 * x4 * 5.17835866925869e-4
        t68 = a1 * x3 * 1.954443358890172e-4
        t79 = a1 * x3 * 1.913629489781766e-4
        t80 = a1 * x4 * 8.101520333949705e-4
        t81 = a1 * x3 * 7.390264655424691e-4
        t87 = a1 * x3 * 2.908111646836174e-4
        t88 = x3 * x4 * 2.208758925076969e-4
        t92 = a1 * 1.330644763823962e-5
        t96 = a1 * x3 * 6.813070078101317e-4
        t101 = a1 * x4 * 1.926290637662159e-4
        t102 = a1 * x3 * 1.942809637984504e-4
        t105 = a1 * x4 * 6.546288738529391e-5
        t124 = a1 * x3 * x4 * 5.46459491697349e-4
        t125 = a1 * x3 * x4 * 3.71461460650226e-4
        t126 = a1 * x4 * 3.512644050516754e-5
        t140 = a1 * x3 * x4 * 3.61653709889379e-5
        t142 = a1 * x3 * x4 * 8.132463227244472e-4
        t148 = a1 * x3 * x4 * 1.897578230656753e-4
        t173 = a1 * x3 * x4 * 4.530747623786782e-5
        t8 = t5 * 3.096117681702037e-3
        t16 = -t12
        t34 = -t17
        t35 = -t18
        t36 = -t19
        t38 = -t20
        t41 = -t22
        t43 = -t24
        t45 = t7 * 3.033062285521275e-4
        t46 = -t27
        t49 = -t28
        t50 = t2 * 4.383015215208348e-3
        t53 = t4 * 2.424433418609366e-2
        t54 = t2 * x3 * 4.609128987279568e-3
        t56 = -t31
        t57 = t5 * 1.246084322200535e-3
        t58 = t7 * 1.974421120797571e-4
        t59 = t4 * 1.174844665218723e-3
        t60 = t4 * 4.068366328593359e-3
        t61 = -t33
        t62 = t3 * 9.824541295055942e-4
        t63 = t3 * 3.889037242445644e-4
        t64 = -t39
        t65 = t3 * 1.9716883609443e-3
        t66 = -t40
        t69 = -t42
        t70 = t5 * 1.462124453624888e-3
        t71 = t2 * x4 * 1.178001929996593e-2
        t72 = t7 * 6.158467419230132e-4
        t73 = -t44
        t74 = t4 * 8.820091710057658e-4
        t75 = t5 * 1.083956223319761e-3
        t77 = t2 * 8.344890531710973e-3
        t78 = t4 * 8.494646760242522e-3
        t82 = -t47
        t83 = t4 * 9.556121159013868e-4
        t84 = t2 * 7.403438706225608e-3
        t85 = t2 * x3 * 8.263052266269669e-3
        t86 = t5 * 1.734051326930353e-3
        t89 = t4 * 2.803305105067517e-3
        t91 = -t51
        t93 = t3 * 2.151121784327437e-3
        t94 = t4 * x4 * 4.602420075191013e-3
        t95 = t4 * 9.977882060873447e-3
        t97 = t5 * 1.155799923633833e-3
        t99 = t7 * 2.087236820282197e-3
        t100 = t2 * 1.492671512682446e-3
        t103 = -t55
        t104 = t2 * 2.406341563218878e-4
        t106 = t2 * x4 * 4.233421692561791e-3
        t108 = t7 * 9.011313026039729e-5
        t109 = t2 * x3 * 2.772981585592439e-3
        t110 = t2 * x4 * 2.362394991619739e-3
        t111 = t3 * 2.438502992052625e-4
        t112 = t2 * x3 * 9.777765864584342e-4
        t113 = t6 * 6.452161038347756e-4
        t114 = t2 * x4 * 5.338375548878287e-4
        t118 = t4 * x4 * 1.008251145454303e-3
        t119 = t2 * 5.443460950245771e-4
        t120 = -t80
        t121 = -t81
        t122 = t4 * x4 * 1.333774656555525e-3
        t123 = t6 * 2.932089650558515e-3
        t127 = t2 * x3 * 3.290068331231388e-3
        t128 = t6 * 3.677661888541652e-3
        t130 = -t87
        t131 = a1 * t4 * 6.700848044330313e-4
        t132 = -t88
        t133 = t2 * 6.417080635794141e-4
        t134 = t7 * 3.09117722011585e-4
        t135 = t2 * x4 * 6.418696313482725e-4
        t136 = t5 * 3.891315190169279e-4
        t137 = t2 * 8.480915259041305e-4
        t138 = t6 * 3.915522813270276e-3
        t139 = t4 * x4 * 1.196884872081109e-3
        t141 = t2 * x4 * 1.291264104482429e-3
        t143 = t3 * 8.191351612963735e-5
        t146 = t3 * 5.267969435152352e-4
        t147 = t4 * x4 * 9.650090139375496e-4
        t149 = t7 * 7.400828294365857e-4
        t150 = -t102
        t151 = t2 * x4 * 4.597075524875421e-4
        t153 = t6 * 2.721941204745107e-5
        t154 = a1 * t4 * 3.347579648093326e-4
        t156 = t6 * 4.573162773259658e-4
        t157 = t2 * x3 * 6.881130736851919e-4
        t160 = a1 * t4 * 5.558685600291015e-4
        t161 = t6 * 2.653331040603493e-3
        t163 = a1 * t4 * 2.748518872984659e-4
        t165 = -t125
        t166 = -t126
        t167 = t4 * x4 * 3.453257662249092e-4
        t171 = t2 * x3 * 3.578910169976219e-4
        t172 = a1 * t4 * 7.106345697330971e-4
        t178 = t6 * 1.919727603023228e-3
        t180 = -t140
        t181 = -t142
        t184 = t4 * x4 * 1.778948546238276e-4
        t187 = t6 * x3 * 1.945432026414117e-3
        t188 = t6 * x3 * 6.569551159369136e-4
        t189 = t6 * x3 * 7.68399685403755e-4
        t190 = a1 * t4 * 7.465380685349496e-5
        t192 = a1 * t6 * 3.643637452155724e-4
        t193 = t6 * x3 * 2.630784542846513e-3
        t194 = t6 * x3 * 6.263656332588557e-4
        t195 = a1 * t6 * 6.138768406302917e-4
        t196 = t6 * x3 * 2.851840578428165e-3
        t197 = -t173
        t198 = a1 * t6 * 2.965615359357048e-4
        t200 = a1 * t6 * 4.25046809405942e-5
        t201 = a1 * t6 * 1.255914965992853e-4
        t202 = a1 * t6 * 2.332273022287487e-4
        t208 = a1 * t4 * 1.09340400782333e-5
        t210 = t6 * x3 * 1.620740246790365e-4
        t212 = a1 * t6 * 3.910860388580276e-5
        t13 = -t8
        t76 = -t45
        t90 = -t50
        t98 = -t54
        t107 = -t60
        t115 = -t70
        t116 = -t75
        t117 = -t77
        t129 = -t86
        t144 = -t95
        t145 = -t97
        t152 = -t106
        t155 = -t108
        t158 = -t109
        t159 = -t111
        t162 = -t113
        t164 = -t123
        t168 = -t127
        t169 = -t128
        t170 = -t133
        t174 = -t134
        t175 = -t135
        t176 = -t137
        t177 = -t138
        t179 = -t139
        t182 = -t146
        t183 = -t147
        t185 = -t154
        t186 = -t156
        t191 = -t161
        t199 = -t178
        t203 = -t187
        t204 = -t189
        t205 = -t190
        t206 = -t193
        t207 = -t194
        t209 = -t196
        t211 = -t201
        t213 = -t208
        t218 = t68+t83+t91+t100+t153+t166+4.543236457933856e-3
        t214 = t26+t53+t56+t82+t84+t169-7.972479128279132e-2
        t215 = t32+t38+t66+t117+t144+t164+9.869401038411515e-3
        t216 = t67+t79+t90+t107+t132+t177+2.535931377160841e-2
        t217 = t48+t59+t101+t104+t130+t186-4.177499966790243e-3
        t219 = t37+t89+t105+t119+t150+t162-1.827407919201807e-2
        t220 = t23+t78+t96+t120+t176+t191-1.450497298603227e-2
        t221 = t61+t73+t74+t121+t170+t199-2.773062646061965e-3
        t222 = t10+t11+t13+t35+t72+t93+t98+t110+t165+t167+t172+t188+t202
        t223 = t14+t43+t46+t65+t71+t94+t99+t129+t160+t168+t181+t203+t211
        t224 = t15+t16+t34+t62+t85+t115+t118+t141+t149+t180+t195+t209+t213
        t225 = t25+t49+t76+t92+t103+t116+t122+t131+t152+t158+t182+t198+t206
        t226 = t30+t41+t63+t69+t124+t145+t151+t163+t171+t174+t183+t192+t204
        t227 = t9+t52+t58+t64+t112+t114+t136+t143+t184+t197+t200+t205+t210
        t228 = t21+t29+t36+t57+t148+t155+t157+t159+t175+t179+t185+t207+t212
        et1 = a1 * 9.434581968614061e-4-t3 * 2.846557840983095e-3-t5 * 2.80776067900825e-3-t7 * 1.865393708674624e-4-x3 * 7.154182093878335e-3
        et2 = x4 * (-1.506486758197239e-3)-a1 * t4 * 8.63541332173525e-4+a1 * t6 * 3.514890065521158e-5-t2 * x3 * 2.798008051039181e-3
        et3 = t2 * x4 * (-6.113621267397044e-4)-t4 * x4 * 1.43683432424383e-4-t6 * x3 * 2.725452346084272e-3-a1 * x3 * x4 * 3.145332791804106e-4
        et4 = a1 * 5.808420122001793e-3-t3 * 1.790450331378886e-2-t5 * 1.206721470106715e-4+t7 * 3.155205989636836e-5-x3 * 1.630289343440822e-2
        et5 = x4 * 2.488861722317103e-3-a1 * t4 * 8.529319073362839e-4-a1 * t6 * 1.323848836940541e-4+t2 * x3 * 4.611255047662506e-3-t2 * x4 * 9.205296993412249e-4
        et6 = t4 * x4 * (-1.07234353382777e-3)-t6 * x3 * 3.726105256669996e-3-a1 * x3 * x4 * 7.495229045341079e-4
        et7 = a1 * 4.906850923285868e-5-t3 * 1.602717484416552e-4+t5 * 1.370592601443221e-4+t7 * 3.293953424453143e-5-x3 * 1.013847861633722e-3
        et8 = x4 * 5.203258370785641e-4-a1 * t4 * 5.279552255395856e-5-a1 * t6 * 1.704856531710824e-5+t2 * x3 * 1.004361186518569e-3
        et9 = t2 * x4 * (-2.288821602763789e-4)-t4 * x4 * 2.624746939568572e-4-t6 * x3 * 7.844108785918015e-5+a1 * x3 * x4 * 5.371377595715672e-5
        et10 = a1 * 1.136755222487557e-2-t3 * 1.160456204135546e-3+t5 * 8.009475277882762e-3-t7 * 3.723811972089604e-4-x3 * 1.275354178491599e-1
        et11 = x4 * 2.058161908130692e-3-a1 * t4 * 2.679856403291559e-3+a1 * t6 * 5.169398811856124e-4+t2 * x3 * 9.235336442599197e-3-t2 * x4 * 3.885589297561155e-3
        et12 = t4 * x4 * 7.323490474291332e-3-t6 * x3 * 6.080523697537407e-3-a1 * x3 * x4 * 1.778787070398734e-3
        et13 = a1 * (-3.485157186889477e-4)-t3 * 4.351597226256723e-3-t5 * 1.292288027005145e-3-t7 * 4.005429726466071e-4+x3 * 2.38703164295028e-2
        et14 = x4 * 1.741605395034505e-2+a1 * t4 * 4.62190546676571e-4-a1 * t6 * 1.216176229344101e-4-t2 * x3 * 6.162538151224985e-3-t2 * x4 * 6.705046559884092e-3
        et15 = t4 * x4 * (-2.600145776301757e-3)-t6 * x3 * 1.008592007815001e-3+a1 * x3 * x4 * 2.81848104449684e-4
        et16 = a1 * (-1.220666647997067e-3)-t3 * 5.203606339158537e-4-t5 * 1.37666676735609e-3+t7 * 1.3113610372212e-3+x3 * 3.055400086533579e-2
        et17 = x4 * 5.929692971880567e-3+a1 * t4 * 6.422727577572741e-4+a1 * t6 * 2.218730084984563e-5-t2 * x3 * 2.083476228841e-2-t2 * x4 * 2.7154107257176e-3
        et18 = t4 * x4 * 8.357838848696087e-4-t6 * x3 * 1.706846535139843e-3+a1 * x3 * x4 * 1.318575187512506e-3
        dW_dvx = np.reshape([et1+et2+et3,t218,t227,t222,t215,t225,t218,et4+et5+et6,t217,t220,t223,t221,t227,t217,et7+et8+et9,t228,t219,t226,t222,t220,t228,et10+et11+et12,t214,t224,t215,t223,t219,t214,et13+et14+et15,t216,t225,t221,t226,t224,t216,et16+et17+et18],(6,6))
        return dW_dvx
    
    def dW_dxi_fcn(self, i, x, a1):
        if i == 2:
            return self.dW_dphi_fcn(x, a1)
        elif i == 3:
            return self.dW_dvx_fcn(x, a1)
        else:
            return np.zeros((6, 6))

    def dW_da0_fcn(self, x, a1):
        #dW_da1
        #    dW_da1 = dW_da1(IN1,A1)

        #    This function was generated by the Symbolic Math Toolbox version 24.2.
        #    20-Feb-2026 02:33:35

        x3 = x[2]
        x4 = x[3]
        t2 = a1 ** 2
        t3 = a1 ** 3
        t4 = x3 ** 2
        t5 = x3 ** 3
        t6 = x4 ** 2
        t7 = x4 ** 3
        t8 = a1 * x3 * 4.889580242377178e-2
        t10 = x3 * 1.281647169659389e-2
        t12 = a1 * 1.470391644063301e-3
        t13 = a1 * x3 * x4 * 9.218257974559135e-3
        t15 = a1 * 7.106933401757655e-2
        t16 = a1 * x3 * 1.680166077525955e-2
        t17 = x3 * 1.230284938007356e-3
        t19 = a1 * x3 * 4.950752431457229e-2
        t20 = x4 * 2.142098463985122e-3
        t21 = x3 * 8.981819283252658e-3
        t22 = x4 * 1.260353611954313e-3
        t23 = x3 * x4 * 2.281626624949682e-4
        t24 = x3 * 1.841502702179635e-3
        t26 = a1 * x3 * 2.088344515672306e-2
        t27 = x3 * 1.439949589716311e-3
        t28 = a1 * x3 * 2.280736189108744e-2
        t30 = x4 * 9.887894042806616e-4
        t31 = x3 * 5.217975199688681e-3
        t32 = a1 * 2.544006939264977e-3
        t33 = a1 * x4 * 1.668978106342195e-2
        t35 = x4 * 7.432491776221308e-4
        t36 = a1 * x3 * 9.274582588989964e-3
        t37 = x3 * 1.3284600580309e-3
        t40 = a1 * x4 * 8.766030430416696e-3
        t41 = x4 * 9.866851179667869e-4
        t42 = a1 * 1.170482649401463e-3
        t43 = a1 * x3 * 4.768510883720484e-2
        t44 = a1 * 7.073158124652383e-3
        t46 = a1 * x4 * 2.985343025364892e-3
        t49 = a1 * x4 * 4.812683126437756e-4
        t53 = a1 * x3 * 1.157396351087242e-2
        t54 = a1 * 4.848039690166591e-4
        t59 = a1 * 1.531821590501171e-4
        t61 = a1 * x4 * 1.088692190049154e-3
        t63 = x3 * x4 * 3.920917607564683e-3
        t65 = a1 * x4 * 1.480687741245122e-2
        t67 = a1 * x3 * x4 * 1.652610453253934e-2
        t69 = a1 * x4 * 1.283416127158828e-3
        t71 = x4 * 3.119378869122657e-4
        t72 = a1 * x4 * 1.696183051808261e-3
        t78 = x3 * x4 * 1.942809637984504e-4
        t84 = a1 * x3 * x4 * 1.376226147370384e-3
        t85 = a1 * x3 * x4 * 5.545963171184878e-3
        t86 = a1 * x3 * x4 * 1.955553172916868e-3
        t90 = x3 * x4 * 1.954443358890172e-4
        t93 = x3 * x4 * 1.913629489781766e-4
        t95 = x3 * x4 * 7.390264655424691e-4
        t98 = a1 * x3 * x4 * 6.580136662462777e-3
        t102 = x3 * x4 * 2.908111646836174e-4
        t105 = a1 * x3 * x4 * 7.157820339952438e-4
        t108 = x4 * 1.330644763823962e-5
        t111 = x3 * x4 * 6.813070078101317e-4
        t9 = -t8
        t11 = -t10
        t14 = -t12
        t18 = -t13
        t25 = -t15
        t29 = a1 * t4 * 5.969609410095733e-2
        t34 = t3 * 4.448614345715765e-3
        t38 = t3 * 1.13898704454933e-1
        t39 = -t16
        t45 = -t17
        t47 = t2 * 1.813398232041473e-2
        t48 = t3 * 1.174012425078517e-1
        t50 = -t20
        t51 = -t22
        t52 = -t23
        t55 = -t26
        t56 = -t30
        t57 = -t32
        t58 = -t33
        t60 = t3 * 6.520933381458992e-3
        t62 = -t35
        t64 = -t37
        t66 = t2 * 5.499984651002331e-2
        t68 = t3 * 4.440136708756175e-2
        t70 = -t40
        t73 = -t44
        t74 = t2 * 8.634477512608365e-2
        t75 = t6 * 8.301109253190627e-4
        t76 = t4 * 1.82858282535272e-3
        t79 = t2 * 1.047293090753868e-2
        t80 = a1 * t4 * 6.109765642320332e-2
        t81 = t4 * 1.372247697000581e-3
        t82 = t3 * 8.577727371743947e-3
        t83 = t2 * 1.102119783289489e-2
        t87 = a1 * t6 * 1.178001929996593e-2
        t88 = -t53
        t89 = -t54
        t91 = t4 * 3.771365129427124e-3
        t92 = t5 * 1.0394028042193e-3
        t94 = t4 * 1.245999072874373e-3
        t96 = -t63
        t97 = t3 * 3.361706653470994e-3
        t99 = t4 * 2.880318157869092e-3
        t101 = t5 * 1.360301427801294e-3
        t103 = t4 * 5.806465281276417e-3
        t104 = -t69
        t106 = t2 * x3 * 2.154765238452484e-2
        t107 = a1 * t4 * 1.780902217741205e-2
        t109 = -t72
        t110 = a1 * t4 * 2.990296961790221e-2
        t112 = t4 * 1.179894229868861e-3
        t113 = t6 * x3 * 6.119081278308728e-4
        t115 = t2 * x3 * 9.205955577050584e-3
        t116 = a1 * t6 * 4.233421692561791e-3
        t117 = t6 * 4.606409311718108e-4
        t118 = -t78
        t119 = t6 * 5.262670498787488e-4
        t120 = t7 * 1.214545817385241e-4
        t121 = t5 * 1.991786729631304e-4
        t122 = a1 * t6 * 2.362394991619739e-3
        t123 = t2 * 6.449448045307227e-3
        t125 = t5 * 6.418218739627314e-4
        t127 = a1 * t4 * 3.35784316480356e-4
        t128 = t4 * 1.632324646483222e-4
        t129 = -t85
        t130 = t6 * 2.589179334629345e-4
        t131 = t7 * 9.88538453119016e-5
        t132 = a1 * t6 * 5.338375548878287e-4
        t133 = t6 * 4.050760166974852e-4
        t135 = t7 * 2.046256135434306e-4
        t136 = -t95
        t138 = t5 * 2.754369941896214e-4
        t139 = a1 * t4 * 5.685665288399909e-3
        t140 = -t98
        t141 = a1 * t6 * 6.418696313482725e-4
        t144 = -t102
        t145 = t4 * x4 * 6.700848044330313e-4
        t147 = a1 * t4 * 9.364949420710597e-3
        t148 = t2 * 4.911165431921918e-3
        t149 = a1 * t6 * 1.291264104482429e-3
        t150 = t2 * x4 * 1.166711172733693e-3
        t151 = t2 * 3.541332462358603e-3
        t153 = t5 * 2.493829779006709e-4
        t154 = t6 * 9.631453188310794e-5
        t156 = a1 * t6 * 4.597075524875421e-4
        t157 = t6 * 3.273144369264696e-5
        t158 = t7 * 7.774243407624957e-5
        t161 = t4 * x4 * 3.347579648093326e-4
        t162 = t5 * 5.02890918298109e-5
        t165 = t2 * x3 * 1.275667819786161e-2
        t166 = t4 * x4 * 5.558685600291015e-4
        t167 = t7 * 1.416822698019807e-5
        t168 = t7 * 4.186383219976175e-5
        t170 = t6 * x3 * 2.732297458486745e-4
        t171 = t6 * x3 * 1.85730730325113e-4
        t172 = t6 * 1.756322025258377e-5
        t173 = t4 * x4 * 2.748518872984659e-4
        t176 = t2 * x3 * 1.775937569511413e-2
        t178 = t2 * x4 * 6.45336535298231e-3
        t179 = t4 * x4 * 7.106345697330971e-4
        t182 = t2 * x4 * 2.947362388516783e-3
        t183 = t6 * x3 * 4.066231613622236e-4
        t184 = t2 * x3 * 8.252921263963506e-3
        t185 = t2 * x4 * 5.9150650828329e-3
        t186 = t2 * x4 * 1.580390830545706e-3
        t187 = t7 * 1.303620129526759e-5
        t189 = t2 * x3 * 2.670359175097155e-3
        t190 = t4 * x4 * 7.465380685349496e-5
        t194 = t2 * x3 * 1.289743476166355e-3
        t195 = t6 * x3 * 2.265373811893391e-5
        t196 = t2 * x4 * 7.315508976157875e-4
        t197 = t2 * x4 * 2.45740548388912e-4
        t198 = t6 * x3 * 1.808268549446895e-5
        t200 = t6 * x3 * 9.487891153283765e-5
        t203 = t4 * x4 * 1.09340400782333e-5
        t77 = -t47
        t100 = -t66
        t114 = -t75
        t124 = -t81
        t126 = -t82
        t134 = -t94
        t137 = -t97
        t142 = -t99
        t143 = -t101
        t146 = -t103
        t152 = -t110
        t155 = -t113
        t159 = -t116
        t160 = -t119
        t163 = -t127
        t164 = -t128
        t169 = -t133
        t174 = -t138
        t175 = -t139
        t177 = -t141
        t180 = -t147
        t181 = -t148
        t188 = -t161
        t191 = -t168
        t192 = -t171
        t193 = -t172
        t199 = -t183
        t201 = -t186
        t202 = -t190
        t204 = -t195
        t205 = -t196
        t206 = -t198
        t207 = -t203
        t209 = t28+t52+t58+t79+t91+t117-1.315199331767812e-2
        t208 = t9+t77+t104+t112+t136+t160-2.083079414645474e-3
        t210 = t19+t65+t96+t114+t123+t146+1.042788683111432e-2
        t211 = t46+t55+t90+t100+t134+t193+2.38150380599674e-2
        t212 = t43+t70+t93+t130+t142+t181+5.493410285079054e-3
        t213 = t74+t76+t88+t109+t111+t169-2.026917313089699e-2
        t214 = t39+t61+t118+t124+t151+t157+1.929724748121679e-3
        t215 = t36+t49+t83+t144+t154+t164-1.446071116926525e-3
        t216 = t11+t18+t48+t51+t73+t80+t122+t125+t158+t176+t178+t179+t192
        t217 = t25+t27+t29+t38+t62+t87+t106+t140+t166+t174+t185+t191+t199
        t218 = t24+t34+t56+t57+t105+t120+t150+t152+t153+t156+t170+t173+t184
        t219 = t14+t21+t50+t67+t68+t135+t143+t149+t165+t180+t182+t206+t207
        t220 = t42+t64+t92+t107+t108+t115+t126+t129+t131+t145+t155+t159+t201
        t221 = t45+t59+t60+t71+t86+t132+t162+t163+t167+t194+t197+t202+t204
        t222 = t31+t41+t84+t89+t121+t137+t175+t177+t187+t188+t189+t200+t205
        et1 = a1 * 2.076497312000037e-2-t3 * 2.277122966743397e-1+t5 * 2.859812230207319e-4+t7 * 1.171630021840386e-5+x3 * 1.83065331238009e-3
        et2 = x4 * 9.434581968614061e-4-a1 * t4 * 3.885259545413728e-2-a1 * t6 * 6.113621267397044e-4-t2 * x3 * 8.331900789150919e-3
        et3 = t2 * x4 * (-8.539673522949284e-3)-t4 * x4 * 8.63541332173525e-4-t6 * x3 * 1.572666395902053e-4-a1 * x3 * x4 * 5.596016102078362e-3
        et4 = a1 * 2.558615074813332e-1-t3 * 1.793671598806979+t5 * 6.255297316497227e-4-t7 * 4.412829456468468e-5-x3 * 9.342980881069625e-5
        et5 = x4 * 5.808420122001793e-3-a1 * t4 * 3.564433930452128e-2-a1 * t6 * 9.205296993412249e-4+t2 * x3 * 1.279505453435481e-2-t2 * x4 * 5.371350994136657e-2
        et6 = t4 * x4 * (-8.529319073362839e-4)-t6 * x3 * 3.747614522670539e-4+a1 * x3 * x4 * 9.222510095325012e-3
        et7 = a1 * 4.958764846235007e-4+t3 * 1.128279271789543e-4-t5 * 5.656700064974183e-5-t7 * 5.682855105702746e-6+x3 * 6.786314714104997e-4
        et8 = x4 * 4.906850923285868e-5+a1 * t4 * 1.233740692251133e-3-a1 * t6 * 2.288821602763789e-4-t2 * x3 * 1.421985987451809e-4
        et9 = t2 * x4 * (-4.808152453249657e-4)-t4 * x4 * 5.279552255395856e-5+t6 * x3 * 2.685688797857836e-5+a1 * x3 * x4 * 2.008722373037139e-3
        et10 = a1 * (-4.359372182180829e-3)-t3 * 2.862544238225843e-2-t5 * 1.873737814723511e-3+t7 * 1.723132937285375e-4+x3 * 2.19974548706558e-2
        et11 = x4 * 1.136755222487557e-2+a1 * t4 * 1.59530727993605e-3-a1 * t6 * 3.885589297561155e-3+t2 * x3 * 8.952272075612414e-3-t2 * x4 * 3.481368612406639e-3
        et12 = t4 * x4 * (-2.679856403291559e-3)-t6 * x3 * 8.89393535199367e-4+a1 * x3 * x4 * 1.847067288519839e-2
        et13 = a1 * 1.384095241371399e-1+t3 * 3.927554523009159e-2+t5 * 6.273590630332839e-4-t7 * 4.053920764480336e-5-x3 * 1.066832476645968e-2
        et14 = x4 * (-3.485157186889477e-4)-a1 * t4 * 7.49657377123404e-3-a1 * t6 * 6.705046559884092e-3+t2 * x3 * 2.091431114760878e-2-t2 * x4 * 1.305479167877017e-2
        et15 = t4 * x4 * 4.62190546676571e-4+t6 * x3 * 1.40924052224842e-4-a1 * x3 * x4 * 1.232507630244997e-2
        et16 = a1 * (-2.145725711773916e-2)+t3 * 1.230687951311537e-1-t5 * 8.461149760714166e-4+t7 * 7.395766949948545e-6+x3 * 9.427395364811721e-3
        et17 = x4 * (-1.220666647997067e-3)+a1 * t4 * 3.718271675963673e-2-a1 * t6 * 2.7154107257176e-3-t2 * x3 * 4.776467906662389e-2-t2 * x4 * 1.561081901747561e-3
        et18 = t4 * x4 * 6.422727577572741e-4+t6 * x3 * 6.592875937562529e-4-a1 * x3 * x4 * 4.166952457682001e-2
        dW_da1 = np.reshape([et1+et2+et3,t211,t221,t216,t209,t220,t211,et4+et5+et6,t215,t213,t217,t208,t221,t215,et7+et8+et9,t222,t214,t218,t216,t213,t222,et10+et11+et12,t210,t219,t209,t217,t214,t210,et13+et14+et15,t212,t220,t208,t218,t219,t212,et16+et17+et18],(6,6))
        return dW_da1

    def dW_dai_fcn(self, i, x, a1):
        if i == 0:
            return self.dW_da0_fcn(x, a1)